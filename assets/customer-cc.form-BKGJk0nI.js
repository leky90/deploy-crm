import{r as d,j as e}from"./index-XwE6gQmn.js";import{z as s,u as B,t as R,F as c}from"./index-MxbznExh.js";import{B as N,d as F}from"./button-C4HOWXLM.js";import{I as g}from"./input-BFqvYdSA.js";import{S as q,a as P,b as D,c as G,d as L}from"./select-BLsJIQQv.js";import{L as m}from"./label-DhoCOihp.js";import{C as T,a as O,b as Q,c as z,d as K,e as M,F as U}from"./vn-bank.field-fT9-E9lv.js";import{P as Y,a as A,b as H}from"./popover-Bx3-hur5.js";import{h as J,g as W}from"./react-icons.esm-5SUvy-NO.js";import{u as X}from"./use-get-customers.query-CnOE94fL.js";import{u as Z}from"./use-get-customer-by-id.query-lOxLSuWh.js";import{u as $}from"./index-Dwx9NaXw.js";const u=s.object({id:s.coerce.number().optional(),id_customer_info:s.coerce.string().nonempty(),creditcard_number:s.coerce.string().min(4),id_vietnamese_bank:s.coerce.number({invalid_type_error:"Required."}),card_is_stored:s.coerce.number({invalid_type_error:"Required."}).min(0,"Required.").max(1,"Required."),name_on_creditcard:s.string().nonempty(),date_exp_creditcard:s.string().min(4)}),V=d.forwardRef(function({onChange:r,name:_,readOnly:p,...o},v){var y;const[n,x]=d.useState(),[t,a]=d.useState(!1),[l,k]=d.useState(),[C,w]=d.useState(),{customers:S,refetchCustomers:E}=X(C),I=i=>{w(i.target.value)};d.useEffect(()=>{k(document.getElementById(_)||void 0)},[]),$(()=>{E()},[C]);const{customer:f}=Z(o.defaultValue?Number(o.defaultValue):void 0),j=S?[n,...S.filter(i=>i.id!==(n==null?void 0:n.id))]:[n];return d.useEffect(()=>{x(f)},[f]),e.jsx("div",{id:_,className:"relative",children:e.jsxs(Y,{open:t,onOpenChange:i=>{i&&setTimeout(()=>{const h=l==null?void 0:l.querySelector("[data-radix-popper-content-wrapper]");h&&(h.style.position="absolute",h.style.width="100%")},0),a(i)},children:[e.jsx(A,{asChild:!0,children:e.jsxs(N,{ref:v,variant:"outline",role:"combobox",className:F("w-full justify-between",p&&"bg-muted pointer-events-none"),children:[n?(y=j==null?void 0:j.find(i=>(i==null?void 0:i.id)===(n==null?void 0:n.id)))==null?void 0:y.full_name:e.jsx("span",{className:"text-muted-foreground font-normal",children:"Select a customer"}),e.jsx(J,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(H,{container:l,className:"w-full p-0",children:e.jsxs(T,{shouldFilter:!1,children:[e.jsx(O,{placeholder:"Search customer by name or phone...",className:"h-9",value:C,onChangeCapture:I,autoComplete:"off"}),e.jsxs(Q,{className:"w-full",children:[e.jsx(z,{children:"No customer found."}),e.jsx(K,{children:j.filter(Boolean).map(i=>e.jsxs(M,{value:String(i==null?void 0:i.id),onSelect:h=>{const b=h===String(n==null?void 0:n.id)?void 0:i;r({target:{name:_,value:b==null?void 0:b.id}}),a(!1),x(b)},children:[i==null?void 0:i.full_name,e.jsx(W,{className:F("ml-auto h-4 w-4",(n==null?void 0:n.id)===(i==null?void 0:i.id)?"opacity-100":"opacity-0")})]},i==null?void 0:i.id))})]})]})})]})})});function he({defaultValues:r,mutation:_,onClose:p}){const{register:o,handleSubmit:v,formState:{errors:n}}=B({defaultValues:r,resolver:R(u)}),x=async t=>{(await _(t)).status&&p&&p()};return e.jsxs("form",{onSubmit:v(x),className:"space-y-4",autoComplete:"off",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"id_customer_info",children:"Customer ID"}),e.jsx(V,{...o("id_customer_info"),defaultValue:r!=null&&r.id_customer_info?String(r==null?void 0:r.id_customer_info):void 0}),e.jsx(c,{error:n.id_customer_info})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"name_on_creditcard",children:"Card name"}),e.jsx(g,{placeholder:"Card name",...o("name_on_creditcard")}),e.jsx(c,{error:n.name_on_creditcard})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"creditcard_number",children:"Credit card number"}),e.jsx(g,{placeholder:"Credit card number",...o("creditcard_number")}),e.jsx(c,{error:n.creditcard_number})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"date_exp_creditcard",children:"Date Expired"}),e.jsx(g,{placeholder:"Date Expired",...o("date_exp_creditcard")}),e.jsx(c,{error:n.date_exp_creditcard})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"id_vietnamese_bank",children:"VN Bank"}),e.jsx(U,{name:o("id_vietnamese_bank").name,onChange:o("id_vietnamese_bank").onChange,onBlur:o("id_vietnamese_bank").onBlur,defaultValue:typeof(r==null?void 0:r.id_vietnamese_bank)>"u"?r==null?void 0:r.id_vietnamese_bank:String(r==null?void 0:r.id_vietnamese_bank)}),e.jsx(c,{error:n.id_vietnamese_bank})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"card_is_stored",children:"Card is stored?"}),e.jsxs(q,{...o("card_is_stored"),defaultValue:typeof(r==null?void 0:r.card_is_stored)>"u"?r==null?void 0:r.card_is_stored:String(r==null?void 0:r.card_is_stored),onValueChange:t=>o("card_is_stored").onChange({target:{name:"card_is_stored",value:t}}),children:[e.jsx(P,{className:"h-8 w-40",children:e.jsx(D,{placeholder:"Set status"})}),e.jsx(G,{children:[{label:"No",value:"0"},{label:"Yes",value:"1"}].map(({label:t,value:a})=>e.jsx(L,{value:a,children:t},a))})]}),e.jsx(c,{error:n.card_is_stored})]}),e.jsx(N,{className:"w-full",children:"Submit"})]})}export{he as F};
