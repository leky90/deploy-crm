import{j as s}from"./index-XwE6gQmn.js";import{a as f,H as g}from"./Helmet-DUuvCvTm.js";import{C as i,a as m,b as c,c as p}from"./card-BA5oHXKG.js";import{u as w}from"./use-auth.cache-CFuprbIQ.js";import{g as _,a as P}from"./get-status.util-DC1d3cyY.js";import{z as a,u as b,t as C,F as o}from"./index-MxbznExh.js";import{B as N}from"./button-C4HOWXLM.js";import{I as l}from"./input-BFqvYdSA.js";import{u as F}from"./useMutation-Czv1wBp1.js";import{L as t}from"./label-DhoCOihp.js";function y(){const{auth:e,getAuthInfo:d}=w(),r=d();return s.jsxs(i,{children:[s.jsx(m,{children:s.jsx(c,{className:"font-medium",children:"Your Profile"})}),s.jsxs(p,{className:"grid grid-cols-[100px_1fr] gap-4",children:[s.jsx("label",{className:"font-bold",children:"ID"}),s.jsx("span",{children:e==null?void 0:e.id}),s.jsx("label",{className:"font-bold",children:"Public ID"}),s.jsx("span",{className:"truncate",children:e==null?void 0:e.public_id}),s.jsx("label",{className:"font-bold",children:"Username"}),s.jsx("span",{children:e==null?void 0:e.username}),s.jsx("label",{className:"font-bold",children:"Full name"}),s.jsx("span",{children:e==null?void 0:e.full_name}),s.jsx("label",{className:"font-bold",children:"Role"}),s.jsx("span",{children:_(r!=null&&r.is_administrator?2:1)}),s.jsx("label",{className:"font-bold",children:"Status"}),s.jsx("span",{children:P(!!(e!=null&&e.status))})]})]})}function S(e){return f({method:"post",url:"/user/ChangePassword",data:e})}function v(){const{mutateAsync:e}=F({mutationFn:S});return{mutationChangePassword:e}}const R=a.object({username:a.string().nonempty(),old_password:a.string().nonempty(),new_password:a.string().nonempty(),re_new_password:a.string().nonempty()}).refine(e=>e.new_password===e.re_new_password,{message:"Passwords don't match",path:["re_new_password"]}).refine(e=>e.new_password!==e.old_password,{message:"The new password must not be the same as the old password",path:["new_password"]});function U(){const{auth:e}=w(),{mutationChangePassword:d}=v(),{register:r,handleSubmit:u,reset:h,formState:{errors:n}}=b({defaultValues:{username:e==null?void 0:e.username},resolver:C(R)}),x=async j=>{(await d(j)).status&&h()};return s.jsxs("form",{onSubmit:u(x),className:"space-y-4",autoComplete:"off",children:[s.jsxs("div",{children:[s.jsx(t,{htmlFor:"username",children:"Username"}),s.jsx(l,{placeholder:"Username",...r("username"),readOnly:!0}),s.jsx(o,{error:n.username})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"old_password",children:"Old Password"}),s.jsx(l,{type:"password",placeholder:"Old Password",...r("old_password")}),s.jsx(o,{error:n.old_password})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"new_password",children:"New Password"}),s.jsx(l,{type:"password",placeholder:"New Password",...r("new_password")}),s.jsx(o,{error:n.new_password})]}),s.jsxs("div",{children:[s.jsx(t,{htmlFor:"re_new_password",children:"Re-new Password"}),s.jsx(l,{type:"password",placeholder:"Re-new Password",...r("re_new_password")}),s.jsx(o,{error:n.re_new_password})]}),s.jsx(N,{className:"w-full",children:"Submit"})]})}function E(){return s.jsxs(i,{children:[s.jsx(m,{children:s.jsx(c,{className:"font-medium",children:"Change password"})}),s.jsx(p,{children:s.jsx(U,{})})]})}function Y(){return s.jsxs(s.Fragment,{children:[s.jsx(g,{children:s.jsx("title",{children:"POS System - Profile"})}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[s.jsx(y,{}),s.jsx(E,{})]})]})}export{Y as default};
