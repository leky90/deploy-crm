import{r as t,j as e,a as V,Q as S,L as F,R as I}from"./index-BBOSr7wM.js";import{C as u}from"./cell-text-ChSs_gCg.js";import{D as w}from"./dialog-button.component-C7zQarz6.js";import{B as N,d as U}from"./button-DqtCoJ9q.js";import{h as R,g as K,e as B,E as L}from"./react-icons.esm-EA0c0Jq7.js";import{D as q}from"./dialog-CznRd4sf.js";import{z as l,u as O,t as Q,F as f}from"./index-CLhdQBHv.js";import{I as v}from"./input-BNsxhIvX.js";import{S as M,a as Y,b as z,c as G,d as A}from"./select-B7uF1bcd.js";import{L as b}from"./label-Dlj4BwLN.js";import{C as H,a as J,b as W,c as X,d as Z,e as $,F as ee}from"./vn-bank.field-BZBqK4pt.js";import{P as re,a as se,b as ce}from"./popover-3hlxaTM7.js";import{u as me}from"./use-get-customers.query-C6DTAcYZ.js";import{u as ie}from"./use-get-customer-by-id.query-Y-yfakWS.js";import{u as oe}from"./index-rqYQCcQn.js";import{u as ue}from"./useMutation-Cup4ynIy.js";import{a as le}from"./Helmet-B_Qq3Yxz.js";import{g as te}from"./get-yes-no.util-C-N_EnQX.js";import{F as ne}from"./customer-info.feature-CXBQ2XZF.js";const ae=l.object({id:l.coerce.number().optional(),id_customer_info:l.coerce.string().nonempty(),creditcard_number:l.coerce.string().min(4),id_vietnamese_bank:l.coerce.number({invalid_type_error:"Required."}),card_is_stored:l.coerce.number({invalid_type_error:"Required."}).min(0,"Required.").max(1,"Required."),name_on_creditcard:l.string().nonempty(),date_exp_creditcard:l.string().min(4)}),de=t.forwardRef(function({onChange:r,name:s,readOnly:o,...i},a){var D;const[m,x]=t.useState(),[n,d]=t.useState(!1),[h,T]=t.useState(),[y,P]=t.useState(),{customers:E,refetchCustomers:j}=me(y),C=c=>{P(c.target.value)};t.useEffect(()=>{T(document.getElementById(s)||void 0)},[]),oe(()=>{j()},[y]);const{customer:k}=ie(i.defaultValue?Number(i.defaultValue):void 0),g=E?[m,...E.filter(c=>c.id!==(m==null?void 0:m.id))]:[m];return t.useEffect(()=>{x(k)},[k]),e.jsxDEV("div",{id:s,className:"relative",children:e.jsxDEV(re,{open:n,onOpenChange:c=>{c&&setTimeout(()=>{const p=h==null?void 0:h.querySelector("[data-radix-popper-content-wrapper]");p&&(p.style.position="absolute",p.style.width="100%")},0),d(c)},children:[e.jsxDEV(se,{asChild:!0,children:e.jsxDEV(N,{ref:a,variant:"outline",role:"combobox",className:U("w-full justify-between",o&&"bg-muted pointer-events-none"),children:[m?(D=g==null?void 0:g.find(c=>(c==null?void 0:c.id)===(m==null?void 0:m.id)))==null?void 0:D.full_name:e.jsxDEV("span",{className:"text-muted-foreground font-normal",children:"Select a customer"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:97,columnNumber:15},this),e.jsxDEV(R,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:101,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:83,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:82,columnNumber:9},this),e.jsxDEV(ce,{container:h,className:"w-full p-0",children:e.jsxDEV(H,{shouldFilter:!1,children:[e.jsxDEV(J,{placeholder:"Search customer by name or phone...",className:"h-9",value:y,onChangeCapture:C,autoComplete:"off"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:106,columnNumber:13},this),e.jsxDEV(W,{className:"w-full",children:[e.jsxDEV(X,{children:"No customer found."},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:114,columnNumber:15},this),e.jsxDEV(Z,{children:g.filter(Boolean).map(c=>e.jsxDEV($,{value:String(c==null?void 0:c.id),onSelect:p=>{const _=p===String(m==null?void 0:m.id)?void 0:c;r({target:{name:s,value:_==null?void 0:_.id}}),d(!1),x(_)},children:[c==null?void 0:c.full_name,e.jsxDEV(K,{className:U("ml-auto h-4 w-4",(m==null?void 0:m.id)===(c==null?void 0:c.id)?"opacity-100":"opacity-0")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:133,columnNumber:21},this)]},c==null?void 0:c.id,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:117,columnNumber:19},this))},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:115,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:113,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:105,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:104,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:64,columnNumber:7},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/fields/customer.field.tsx",lineNumber:63,columnNumber:5},this)});function fe({defaultValues:r,mutation:s,onClose:o}){const{register:i,handleSubmit:a,formState:{errors:m}}=O({defaultValues:r,resolver:Q(ae)}),x=async n=>{(await s(n)).status&&o&&o()};return e.jsxDEV("form",{onSubmit:a(x),className:"space-y-4",autoComplete:"off",children:[e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"id_customer_info",children:"Customer ID"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:52,columnNumber:9},this),e.jsxDEV(de,{...i("id_customer_info"),defaultValue:r!=null&&r.id_customer_info?String(r==null?void 0:r.id_customer_info):void 0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:53,columnNumber:9},this),e.jsxDEV(f,{error:m.id_customer_info},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:61,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:51,columnNumber:7},this),e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"name_on_creditcard",children:"Card name"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:65,columnNumber:9},this),e.jsxDEV(v,{placeholder:"Card name",...i("name_on_creditcard")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:66,columnNumber:9},this),e.jsxDEV(f,{error:m.name_on_creditcard},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:67,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:64,columnNumber:7},this),e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"creditcard_number",children:"Credit card number"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:71,columnNumber:9},this),e.jsxDEV(v,{placeholder:"Credit card number",...i("creditcard_number")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:72,columnNumber:9},this),e.jsxDEV(f,{error:m.creditcard_number},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:76,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:70,columnNumber:7},this),e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"date_exp_creditcard",children:"Date Expired"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:80,columnNumber:9},this),e.jsxDEV(v,{placeholder:"Date Expired",...i("date_exp_creditcard")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:81,columnNumber:9},this),e.jsxDEV(f,{error:m.date_exp_creditcard},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:85,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:79,columnNumber:7},this),e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"id_vietnamese_bank",children:"VN Bank"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:89,columnNumber:9},this),e.jsxDEV(ee,{name:i("id_vietnamese_bank").name,onChange:i("id_vietnamese_bank").onChange,onBlur:i("id_vietnamese_bank").onBlur,defaultValue:typeof(r==null?void 0:r.id_vietnamese_bank)>"u"?r==null?void 0:r.id_vietnamese_bank:String(r==null?void 0:r.id_vietnamese_bank)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:90,columnNumber:9},this),e.jsxDEV(f,{error:m.id_vietnamese_bank},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:100,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:88,columnNumber:7},this),e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"card_is_stored",children:"Card is stored?"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:104,columnNumber:9},this),e.jsxDEV(M,{...i("card_is_stored"),defaultValue:typeof(r==null?void 0:r.card_is_stored)>"u"?r==null?void 0:r.card_is_stored:String(r==null?void 0:r.card_is_stored),onValueChange:n=>i("card_is_stored").onChange({target:{name:"card_is_stored",value:n}}),children:[e.jsxDEV(Y,{className:"h-8 w-40",children:e.jsxDEV(z,{placeholder:"Set status"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:119,columnNumber:13},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:118,columnNumber:11},this),e.jsxDEV(G,{children:[{label:"No",value:"0"},{label:"Yes",value:"1"}].map(({label:n,value:d})=>e.jsxDEV(A,{value:d,children:n},d,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:126,columnNumber:15},this))},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:121,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:105,columnNumber:9},this),e.jsxDEV(f,{error:m.card_is_stored},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:132,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:103,columnNumber:7},this),e.jsxDEV(N,{className:"w-full",children:"Submit"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:135,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-cc/customer-cc.form.tsx",lineNumber:46,columnNumber:5},this)}function be(r){return le({method:"patch",url:"/customer_creditcard",data:r})}function pe(){const{mutateAsync:r}=ue({mutationFn:be,onSuccess:()=>{V.invalidateQueries({queryKey:S.CUSTOMER_CC})}});return{mutationUpdateCustomerCc:r}}function Ne({row:r}){const s=t.useRef(null);function o(){var a;(a=s.current)==null||a.click()}const{mutationUpdateCustomerCc:i}=pe();return e.jsxDEV(w,{title:"Update customer credit card",className:"w-96",trigger:e.jsxDEV(N,{variant:"outline",size:"icon",children:e.jsxDEV(B,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer-cc.feature.tsx",lineNumber:30,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer-cc.feature.tsx",lineNumber:29,columnNumber:9},this),actionButtons:e.jsxDEV(q,{asChild:!0,children:e.jsxDEV(N,{ref:s,type:"button",variant:"secondary",children:"Close"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer-cc.feature.tsx",lineNumber:35,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer-cc.feature.tsx",lineNumber:34,columnNumber:9},this),children:e.jsxDEV(fe,{defaultValues:r.original,onClose:o,mutation:i},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer-cc.feature.tsx",lineNumber:41,columnNumber:7},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer-cc.feature.tsx",lineNumber:25,columnNumber:5},this)}const Re={id:!0,id_customer_info:!0,id_vietnamese_bank:!0,card_is_stored:!0,name_on_creditcard:!0,creditcard_number:!0,date_exp_creditcard:!0,last_update:!1,time_insert:!1},Ke=({vnBanks:r})=>[{accessorKey:"id",header:"ID",enableHiding:!1,cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:35,columnNumber:14},void 0)},{accessorKey:"id_customer_info",header:"Customer Info ID",cell:s=>e.jsxDEV(ne,{id:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:42,columnNumber:14},void 0)},{accessorKey:"id_vietnamese_bank",header:"Bank Name",cell:s=>{var o;return e.jsxDEV(u,{children:(o=r==null?void 0:r[s.getValue()])==null?void 0:o.short_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:50,columnNumber:9},void 0)}},{accessorKey:"card_is_stored",header:"Card Is Stored",cell:s=>e.jsxDEV(u,{children:te(s.getValue())},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:58,columnNumber:14},void 0)},{accessorKey:"name_on_creditcard",header:"Card Name",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:65,columnNumber:14},void 0)},{accessorKey:"creditcard_number",header:"CC Number",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:72,columnNumber:14},void 0)},{accessorKey:"date_exp_creditcard",header:"Date Expired",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:79,columnNumber:14},void 0)},{accessorKey:"last_update",header:"Last update",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:86,columnNumber:14},void 0)},{accessorKey:"time_insert",header:"Created time",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:93,columnNumber:14},void 0)},{id:"actions",enableHiding:!1,cell:({row:s})=>e.jsxDEV("div",{className:"space-x-2 truncate",children:[e.jsxDEV(Ne,{row:s},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:102,columnNumber:11},void 0),e.jsxDEV(F,{to:I.CUSTOMER_CC_DETAIL.replace(":id",String(s.original.id)),className:"text-primary",children:e.jsxDEV(N,{variant:"outline",size:"icon",children:e.jsxDEV(L,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:111,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:110,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:103,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-cc.column.tsx",lineNumber:101,columnNumber:9},void 0)}];export{fe as F,Re as c,Ke as g};
