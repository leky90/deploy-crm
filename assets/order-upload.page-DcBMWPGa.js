import{a as g,Q as y,e as j,r as U,j as s,R as n,b as S}from"./index-Do2QKNGk.js";import{a as x,H as P}from"./Helmet-C3JY7vFc.js";import{u as k,a as C}from"./use-get-customer-history-by-id.query-4YenYI2h.js";import{u as V}from"./use-get-customer-by-id.query-DQYiloMc.js";import{z as u,u as O,t as A,F as d}from"./index-CqsOmylt.js";import{B as p}from"./button-e30OhjXb.js";import{u as _}from"./useMutation-Br87UrH6.js";import{c as w}from"./convert-data-to-form-data.util-CYcIkezp.js";import{L as f}from"./label-Izo_8SoM.js";import{I as b}from"./input-uIjAPASV.js";import{M as N,A as h}from"./upload.constant-D3d5R5uO.js";import{A as M,a as I,b as R,c as F,d as B,e as Q,f as z,g as H,h as L}from"./alert-dialog-DP4bnzch.js";import{B as Y}from"./bill-info-Dc8meXrt.js";import"./useQuery-BMvn2REM.js";import"./Combination-JqIHk-Nq.js";import"./index-CfmAVdDB.js";import"./format-currency-DwwnROlR.js";import"./format-percent-Ca7gawAv.js";function q(r){const e=w(r);return x({method:"post",url:"/customer_history/order_step2",data:e,headers:{"Content-Type":"multipart/form-data"}})}function G(){const{mutateAsync:r}=_({mutationFn:q,onSuccess:e=>{e.status&&g.invalidateQueries({queryKey:y.CUSTOMER_HISTORY})}});return{mutationCreateOrderStep2:r}}function K(r){return x({method:"post",url:"/customer_history/order_step2_1",data:r})}function W(){const{mutateAsync:r}=_({mutationFn:K,onSuccess:e=>{e.status&&g.invalidateQueries({queryKey:y.CUSTOMER_HISTORY})}});return{mutationCreateOrderStep2_1:r}}const X=u.object({uuid_id:u.string({required_error:"Required."}),images_creditcard_due_withdrawn:u.any().refine(r=>{var e;return!(r!=null&&r.length)||!((e=Array.from(r))!=null&&e.some(t=>t.size>N))},"Max file size is 5MB.").refine(r=>{var e;return!(r!=null&&r.length)||!((e=Array.from(r))!=null&&e.some(t=>!h.includes(t.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional(),images_transfer_money_to_customer:u.any().refine(r=>{var e;return!(r!=null&&r.length)||!((e=Array.from(r))!=null&&e.some(t=>t.size>N))},"Max file size is 5MB.").refine(r=>{var e;return!(r!=null&&r.length)||!((e=Array.from(r))!=null&&e.some(t=>!h.includes(t.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional()});function Z({bill:r}){const e=j(),[t,l]=U.useState(!1),{register:o,handleSubmit:i,formState:{errors:m}}=O({defaultValues:{uuid_id:r.uuid_id},resolver:A(X)}),{mutationCreateOrderStep2:E}=G();W();const{mutationCancelOrder:T}=k(),v=async c=>{let a=null;t?e(n.CUSTOMER_HISTORIES):a=await E(c),a!=null&&a.status&&e(n.CUSTOMER_HISTORIES)},D=async()=>{(await T({uuid_id:r.uuid_id})).status&&e(n.CUSTOMER_HISTORIES)};return s.jsxDEV("form",{onSubmit:i(v),className:"grid grid-cols-2 gap-4 max-w-2xl mx-auto",autoComplete:"off",children:[s.jsxDEV(Y,{bill:r},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:81,columnNumber:7},this),!t&&s.jsxDEV("div",{className:"grid col-span-2 md:grid-cols-2 gap-4",children:[s.jsxDEV("div",{className:"space-y-4",children:[s.jsxDEV(f,{htmlFor:"images_creditcard_due_withdrawn",children:"Credit card Due/Withdrawn images"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:100,columnNumber:13},this),s.jsxDEV(b,{type:"file",multiple:!0,accept:".gif, .jpg, .jpeg, .png, .pdf",...o("images_creditcard_due_withdrawn")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:103,columnNumber:13},this),s.jsxDEV(d,{error:m.images_creditcard_due_withdrawn},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:109,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:99,columnNumber:11},this),s.jsxDEV("div",{className:"space-y-4",children:[s.jsxDEV(f,{htmlFor:"images_transfer_money_to_customer",children:"Transfer money to customer images"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:115,columnNumber:13},this),s.jsxDEV(b,{type:"file",multiple:!0,accept:".gif, .jpg, .jpeg, .png, .pdf",...o("images_transfer_money_to_customer")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:118,columnNumber:13},this),s.jsxDEV(d,{error:m.images_transfer_money_to_customer},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:124,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:114,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:98,columnNumber:9},this),s.jsxDEV("div",{className:"mt-4 grid grid-cols-2 gap-4 col-span-2",children:[s.jsxDEV(M,{children:[s.jsxDEV(I,{asChild:!0,children:s.jsxDEV(p,{type:"button",variant:"destructive",children:"Cancel Order"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:134,columnNumber:13},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:133,columnNumber:11},this),s.jsxDEV(R,{children:[s.jsxDEV(F,{children:[s.jsxDEV(B,{children:"Are you absolutely sure?"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:140,columnNumber:15},this),s.jsxDEV(Q,{children:"This action cannot be undone. This will permanently cancel this order and can not revert."},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:141,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:139,columnNumber:13},this),s.jsxDEV(z,{children:[s.jsxDEV(H,{children:"Cancel"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:147,columnNumber:15},this),s.jsxDEV(L,{variant:"default",onClick:D,children:"Confirm"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:148,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:146,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:138,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:132,columnNumber:9},this),s.jsxDEV(p,{type:"submit",className:"w-full",children:"Submit"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:154,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:131,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:76,columnNumber:5},this)}function J(){var i;const r=S(),{customerHistory:e}=C(Number(r.id)),{customer:t}=V(e==null?void 0:e.id_customer_info),l=(i=t==null?void 0:t.list_customer_creditcard)==null?void 0:i.find(m=>m.id===(e==null?void 0:e.id_customer_creditcard));let o=null;return e&&l&&t&&(o={card_type:e==null?void 0:e.card_type,customer_name:t==null?void 0:t.full_name,customer_creditcard:l.creditcard_number,fee:Number(e.fee),money_applied_percent:Number(e.money_applied_percent),money_total:Number(e.money_total),percent_to_charge:Number(e.percent_to_charge),note:e.note,rate_option:String(e.rate_option),user_option:String(e.user_option),uuid_id:e.uuid_id}),s.jsxDEV("div",{className:"space-y-6 px-4 py-4",children:[s.jsxDEV("div",{className:"flex items-center flex-col lg:flex-row justify-between space-y-2",children:s.jsxDEV("h2",{className:"text-2xl lg:text-3xl font-bold max-w-2xl mx-auto tracking-tight",children:["Upload Order: ",r.id]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-upload.container.tsx",lineNumber:38,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-upload.container.tsx",lineNumber:37,columnNumber:7},this),o&&s.jsxDEV(Z,{bill:o},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-upload.container.tsx",lineNumber:42,columnNumber:16},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-upload.container.tsx",lineNumber:36,columnNumber:5},this)}function he(){return s.jsxDEV(s.Fragment,{children:[s.jsxDEV(P,{children:s.jsxDEV("title",{children:"POS System - Order Upload"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-upload.page.tsx",lineNumber:8,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-upload.page.tsx",lineNumber:7,columnNumber:7},this),s.jsxDEV(J,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-upload.page.tsx",lineNumber:10,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-upload.page.tsx",lineNumber:6,columnNumber:5},this)}export{he as default};
