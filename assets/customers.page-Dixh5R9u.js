import{j as r,a as y,Q as x,r as c,L as P,R as j,k}from"./index-BY9egYhW.js";import{B as a,a as h,H as C}from"./Helmet-ClrgHUyv.js";import{D as V}from"./data-table-_fX450cL.js";import{C as n}from"./cell-text-DbXrKnYw.js";import{D as v,a as E}from"./dialog-button.component-CSABBZrY.js";import{d as _,E as S,P as F}from"./react-icons.esm-DO47ONlk.js";import{z as l,u as I,t as R,I as N,F as p}from"./index-CCxijaIC.js";import{M,A as w}from"./upload.constant-sHXMtF6P.js";import{S as K,a as A,b as q,c as L,d as O}from"./select--WQDjXNr.js";import{L as b}from"./label-DsxFzG3k.js";import{G as Q,g as B}from"./get-customer-image-url.util-Dbywk-8N.js";import{u as D}from"./useMutation-psXQFSIX.js";import{g as z}from"./get-yes-no.util-C-N_EnQX.js";import{u as Y}from"./useQuery-Bst-_8Y-.js";import"./index-CGDEZ85P.js";import"./index-D85UzQdK.js";import"./dropdown-menu-s5hM6OTG.js";const G=l.object({id:l.coerce.number().optional(),full_name:l.coerce.string().nonempty(),phonenumber:l.coerce.string(),is_active:l.coerce.number({invalid_type_error:"Required."}).min(0,"Required.").max(1,"Required."),images_identify_card:l.any().refine(e=>{var s;return!(e!=null&&e.length)||!((s=Array.from(e))!=null&&s.some(m=>m.size>M))},"Max file size is 5MB.").refine(e=>{var s;return!(e!=null&&e.length)||!((s=Array.from(e))!=null&&s.some(m=>!w.includes(m.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional()});function U({defaultValues:e,mutation:s,onClose:m}){var f;const{register:i,handleSubmit:t,formState:{errors:u}}=I({defaultValues:e,resolver:R(G)}),g=async o=>{(await s(o)).status&&m&&m()};return r.jsxDEV("form",{onSubmit:t(g),className:"space-y-4",autoComplete:"off",children:[r.jsxDEV("div",{children:[r.jsxDEV(b,{htmlFor:"full_name",children:"Full name"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:57,columnNumber:9},this),r.jsxDEV(N,{placeholder:"Full name",...i("full_name")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:58,columnNumber:9},this),r.jsxDEV(p,{error:u.full_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:59,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:56,columnNumber:7},this),r.jsxDEV("div",{children:[r.jsxDEV(b,{htmlFor:"phonenumber",children:"Phone number"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:63,columnNumber:9},this),r.jsxDEV(N,{placeholder:"Phone number",...i("phonenumber")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:64,columnNumber:9},this),r.jsxDEV(p,{error:u.phonenumber},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:65,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:62,columnNumber:7},this),r.jsxDEV("div",{children:[r.jsxDEV(b,{htmlFor:"is_active",children:"Active"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:69,columnNumber:9},this),r.jsxDEV(K,{...i("is_active"),defaultValue:typeof(e==null?void 0:e.is_active)>"u"?e==null?void 0:e.is_active:String(e==null?void 0:e.is_active),onValueChange:o=>i("is_active").onChange({target:{name:"is_active",value:o}}),children:[r.jsxDEV(A,{className:"h-8 w-40",children:r.jsxDEV(q,{placeholder:"Set status"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:84,columnNumber:13},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:83,columnNumber:11},this),r.jsxDEV(L,{children:[{label:"No",value:"0"},{label:"Yes",value:"1"}].map(({label:o,value:d})=>r.jsxDEV(O,{value:d,children:o},d,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:91,columnNumber:15},this))},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:86,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:70,columnNumber:9},this),r.jsxDEV(p,{error:u.is_active},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:97,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:68,columnNumber:7},this),r.jsxDEV("div",{className:"space-y-1",children:[r.jsxDEV(b,{htmlFor:"images_identify_card",children:"Customer Images"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:101,columnNumber:9},this),r.jsxDEV(Q,{images:(f=e==null?void 0:e.images_identify_card)==null?void 0:f.map(B)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:102,columnNumber:9},this),r.jsxDEV(N,{type:"file",multiple:!0,accept:"image/*",...i("images_identify_card")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:107,columnNumber:9},this),r.jsxDEV(p,{error:u.images_identify_card},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:113,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:100,columnNumber:7},this),r.jsxDEV(a,{className:"w-full",children:"Submit"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:118,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:51,columnNumber:5},this)}function T(e){var m;const s=new FormData;for(const i in e)if(((m=e[i])==null?void 0:m.constructor.name)==="FileList"){const t=e[i];for(let u=0;u<t.length;u++)s.append(i,t.item(u))}else s.append(i,e[i]);return s}function H(e){const s=T(e);return h({method:"patch",url:"/customer_info/update_customers",data:s,headers:{"Content-Type":"multipart/form-data"}})}function X(){const{mutateAsync:e}=D({mutationFn:H,onSuccess:()=>{y.invalidateQueries({queryKey:x.CUSTOMER})}});return{mutationUpdateCustomer:e}}function Z({row:e}){const s=c.useRef(null);function m(){var t;(t=s.current)==null||t.click()}const{mutationUpdateCustomer:i}=X();return r.jsxDEV(v,{title:"Update customer info",className:"w-96",trigger:r.jsxDEV(a,{variant:"outline",size:"icon",children:r.jsxDEV(_,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:30,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:29,columnNumber:9},this),actionButtons:r.jsxDEV(E,{asChild:!0,children:r.jsxDEV(a,{ref:s,type:"button",variant:"secondary",children:"Close"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:35,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:34,columnNumber:9},this),children:r.jsxDEV(U,{defaultValues:e.original,onClose:m,mutation:i},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:41,columnNumber:7},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:25,columnNumber:5},this)}const J={id:!0,full_name:!0,is_active:!0,phonenumber:!0,images_identify_card:!0,uuid_id:!0},W=()=>[{accessorKey:"id",header:"ID",enableHiding:!1,cell:e=>r.jsxDEV(n,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:28,columnNumber:14},void 0)},{accessorKey:"full_name",header:"Full Name",cell:e=>r.jsxDEV(n,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:35,columnNumber:14},void 0)},{accessorKey:"is_active",header:"Active",cell:e=>r.jsxDEV(n,{children:z(e.getValue())},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:42,columnNumber:14},void 0)},{accessorKey:"phonenumber",header:"Phone Number",cell:e=>r.jsxDEV(n,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:49,columnNumber:14},void 0)},{accessorKey:"images_identify_card",header:"Identify Images",cell:e=>r.jsxDEV(n,{children:e.getValue().length},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:56,columnNumber:14},void 0)},{accessorKey:"uuid_id",header:"UUID",cell:e=>r.jsxDEV(n,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:63,columnNumber:14},void 0)},{id:"actions",enableHiding:!1,cell:({row:e})=>r.jsxDEV("div",{className:"space-x-2",children:[r.jsxDEV(Z,{row:e},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:72,columnNumber:11},void 0),r.jsxDEV(P,{to:j.CUSTOMER_DETAIL.replace(":id",String(e.original.id)),className:"text-primary",children:r.jsxDEV(a,{variant:"outline",size:"icon",children:r.jsxDEV(S,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:78,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:77,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:73,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:71,columnNumber:9},void 0)}];function $(){return h({url:"/customer_info/get_all"})}function ee(e){return h({url:"/customer_info/search",params:{keywords:e}})}function re(e){const{data:s,refetch:m}=Y({queryKey:x.CUSTOMER,queryFn:e?()=>ee(e):$,placeholderData:k,gcTime:1e4});return{customers:s==null?void 0:s.result,refetchCustomers:m}}function se(e){const s=T(e);return h({method:"post",url:"/customer_info/add_customers",data:s,headers:{"Content-Type":"multipart/form-data"}})}function me(){const{mutateAsync:e}=D({mutationFn:se,onSuccess:s=>{s.status&&y.invalidateQueries({queryKey:x.CUSTOMER})}});return{mutationCreateCustomer:e}}function ie(){const e=c.useRef(null);function s(){var i;(i=e.current)==null||i.click()}const{mutationCreateCustomer:m}=me();return r.jsxDEV(v,{title:"Create new customer",className:"w-96",trigger:r.jsxDEV(a,{className:"gap-2",children:[r.jsxDEV(F,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:24,columnNumber:11},this)," Create new customer"]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:23,columnNumber:9},this),actionButtons:r.jsxDEV(E,{asChild:!0,children:r.jsxDEV(a,{ref:e,type:"button",variant:"secondary",children:"Close"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:29,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:28,columnNumber:9},this),children:r.jsxDEV(U,{onClose:s,mutation:m},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:35,columnNumber:7},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:19,columnNumber:5},this)}function ue(){const[e,s]=c.useState(J),[m,i]=c.useState(),t=c.useDeferredValue(m),{customers:u,refetchCustomers:g}=re(t),f=c.useMemo(()=>W(),[]),o=d=>{i(d.target.value)};return c.useEffect(()=>{g()},[t]),r.jsxDEV("div",{className:"space-y-6 px-4 py-4",children:[r.jsxDEV("div",{className:"flex items-center justify-between space-y-2",children:[r.jsxDEV("h2",{className:"text-3xl font-bold tracking-tight",children:"Customers"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:41,columnNumber:9},this),r.jsxDEV("div",{className:"flex items-center space-x-2",children:[r.jsxDEV(N,{type:"search",placeholder:"Search customers",value:m,onChange:o},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:43,columnNumber:11},this),r.jsxDEV(ie,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:49,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:42,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:40,columnNumber:7},this),r.jsxDEV(V,{data:u,columns:f,columnVisibility:e,rowCount:u==null?void 0:u.length,onColumnVisibilityChange:s,hidePagination:!0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:52,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:39,columnNumber:5},this)}function De(){return r.jsxDEV(r.Fragment,{children:[r.jsxDEV(C,{children:r.jsxDEV("title",{children:"POS System - Customers"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:8,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:7,columnNumber:7},this),r.jsxDEV(ue,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:10,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:6,columnNumber:5},this)}export{De as default};
