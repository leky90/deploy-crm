import{j as e,a as g,Q as h,r as l,L as k,R as C}from"./index-CrgaQZZi.js";import{a as y,H as V}from"./Helmet-BtZ7U0QR.js";import{u as _,D as S}from"./index-DCPbyJaZ.js";import{C as d}from"./cell-text-BNg_TNdP.js";import{D as v}from"./dialog-button.component-B5eUm09p.js";import{B as n}from"./button-CrLqvpvw.js";import{e as F,E as w,P as I}from"./react-icons.esm-DuamYfJ8.js";import{D as E}from"./dialog-BlCK8-DU.js";import{z as c,u as R,t as M,F as p}from"./index-DqrNToSo.js";import{I as N}from"./input-BZy6TJT9.js";import{M as A,A as K}from"./upload.constant-D3d5R5uO.js";import{S as L,a as B,b as O,c as Q,d as q}from"./select-DrFuJnQx.js";import{L as b}from"./label-BrUVK09T.js";import{G as D}from"./grid-images-DRNZw6MP.js";import{g as U}from"./get-customer-image-url.util-dqnr5XYm.js";import{u as T}from"./useMutation-Dd67b7hD.js";import{c as P}from"./convert-data-to-form-data.util-CYcIkezp.js";import{g as z}from"./get-yes-no.util-C-N_EnQX.js";import{u as Y}from"./use-get-customers.query-DgWropyC.js";import"./Combination-D6Jm7gtk.js";import"./index-7iSC9myz.js";import"./dropdown-menu-2K5Ff67t.js";import"./index-BD-Wf0QL.js";import"./index-D3Fi_Hth.js";import"./useQuery-lrpO5rpq.js";const G=c.object({id:c.coerce.number().optional(),full_name:c.coerce.string().nonempty(),phonenumber:c.coerce.string(),is_active:c.coerce.number({invalid_type_error:"Required."}).min(0,"Required.").max(1,"Required."),images_identify_card:c.any().refine(r=>{var s;return!(r!=null&&r.length)||!((s=Array.from(r))!=null&&s.some(m=>m.size>A))},"Max file size is 5MB.").refine(r=>{var s;return!(r!=null&&r.length)||!((s=Array.from(r))!=null&&s.some(m=>!K.includes(m.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional()});function j({defaultValues:r,mutation:s,onClose:m}){var f;const{register:i,handleSubmit:o,formState:{errors:u}}=R({defaultValues:r,resolver:M(G)}),x=async t=>{(await s(t)).status&&m&&m()};return e.jsxDEV("form",{onSubmit:o(x),className:"space-y-4",autoComplete:"off",children:[e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"full_name",children:"Full name"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:57,columnNumber:9},this),e.jsxDEV(N,{placeholder:"Full name",...i("full_name")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:58,columnNumber:9},this),e.jsxDEV(p,{error:u.full_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:59,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:56,columnNumber:7},this),e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"phonenumber",children:"Phone number"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:63,columnNumber:9},this),e.jsxDEV(N,{placeholder:"Phone number",...i("phonenumber")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:64,columnNumber:9},this),e.jsxDEV(p,{error:u.phonenumber},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:65,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:62,columnNumber:7},this),e.jsxDEV("div",{children:[e.jsxDEV(b,{htmlFor:"is_active",children:"Active"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:69,columnNumber:9},this),e.jsxDEV(L,{...i("is_active"),defaultValue:typeof(r==null?void 0:r.is_active)>"u"?r==null?void 0:r.is_active:String(r==null?void 0:r.is_active),onValueChange:t=>i("is_active").onChange({target:{name:"is_active",value:t}}),children:[e.jsxDEV(B,{className:"h-8 w-40",children:e.jsxDEV(O,{placeholder:"Set status"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:84,columnNumber:13},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:83,columnNumber:11},this),e.jsxDEV(Q,{children:[{label:"No",value:"0"},{label:"Yes",value:"1"}].map(({label:t,value:a})=>e.jsxDEV(q,{value:a,children:t},a,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:91,columnNumber:15},this))},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:86,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:70,columnNumber:9},this),e.jsxDEV(p,{error:u.is_active},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:97,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:68,columnNumber:7},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(b,{htmlFor:"images_identify_card",children:"Customer Images"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:101,columnNumber:9},this),e.jsxDEV(D,{images:(f=r==null?void 0:r.images_identify_card)==null?void 0:f.map(U)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:102,columnNumber:9},this),e.jsxDEV(N,{type:"file",multiple:!0,accept:"image/*",...i("images_identify_card")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:107,columnNumber:9},this),e.jsxDEV(p,{error:u.images_identify_card},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:113,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:100,columnNumber:7},this),e.jsxDEV(n,{className:"w-full",children:"Submit"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:118,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer/customer.form.tsx",lineNumber:51,columnNumber:5},this)}function H(r){const s=P(r);return y({method:"patch",url:"/customer_info/update_customers",data:s,headers:{"Content-Type":"multipart/form-data"}})}function X(){const{mutateAsync:r}=T({mutationFn:H,onSuccess:()=>{g.invalidateQueries({queryKey:h.CUSTOMER})}});return{mutationUpdateCustomer:r}}function Z({row:r}){const s=l.useRef(null);function m(){var o;(o=s.current)==null||o.click()}const{mutationUpdateCustomer:i}=X();return e.jsxDEV(v,{title:"Update customer info",className:"w-96",trigger:e.jsxDEV(n,{variant:"outline",size:"icon",children:e.jsxDEV(F,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:30,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:29,columnNumber:9},this),actionButtons:e.jsxDEV(E,{asChild:!0,children:e.jsxDEV(n,{ref:s,type:"button",variant:"secondary",children:"Close"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:35,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:34,columnNumber:9},this),children:e.jsxDEV(j,{defaultValues:r.original,onClose:m,mutation:i},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:41,columnNumber:7},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/update-customer.feature.tsx",lineNumber:25,columnNumber:5},this)}const J={id:!0,full_name:!0,is_active:!0,phonenumber:!0,images_identify_card:!0,uuid_id:!1},W=()=>[{accessorKey:"id",header:"ID",enableHiding:!1,cell:r=>e.jsxDEV(d,{children:r.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:30,columnNumber:14},void 0)},{accessorKey:"full_name",header:"Full Name",cell:r=>e.jsxDEV(d,{children:r.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:37,columnNumber:14},void 0)},{accessorKey:"is_active",header:"Active",cell:r=>e.jsxDEV(d,{children:z(r.getValue())},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:44,columnNumber:14},void 0)},{accessorKey:"phonenumber",header:"Phone Number",cell:r=>e.jsxDEV(d,{children:r.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:51,columnNumber:14},void 0)},{accessorKey:"images_identify_card",header:"Identify Images",cell:r=>e.jsxDEV(D,{className:"grid-cols-2 max-w-xs min-w-[180px]",images:r.getValue().map(U)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:59,columnNumber:9},void 0)},{accessorKey:"uuid_id",header:"UUID",cell:r=>e.jsxDEV(d,{className:"w-20",children:r.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:70,columnNumber:14},void 0)},{id:"actions",enableHiding:!1,cell:({row:r})=>e.jsxDEV("div",{className:"space-x-2 truncate",children:[e.jsxDEV(Z,{row:r},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:79,columnNumber:11},void 0),e.jsxDEV(k,{to:C.CUSTOMER_DETAIL.replace(":id",String(r.original.id)),className:"text-primary",children:e.jsxDEV(n,{variant:"outline",size:"icon",children:e.jsxDEV(w,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:85,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:84,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:80,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer.column.tsx",lineNumber:78,columnNumber:9},void 0)}];function $(r){const s=P(r);return y({method:"post",url:"/customer_info/add_customers",data:s,headers:{"Content-Type":"multipart/form-data"}})}function ee(){const{mutateAsync:r}=T({mutationFn:$,onSuccess:s=>{s.status&&g.invalidateQueries({queryKey:h.CUSTOMER})}});return{mutationCreateCustomer:r}}function re(){const r=l.useRef(null);function s(){var i;(i=r.current)==null||i.click()}const{mutationCreateCustomer:m}=ee();return e.jsxDEV(v,{title:"Create new customer",className:"w-96",trigger:e.jsxDEV(n,{className:"gap-2",children:[e.jsxDEV(I,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:24,columnNumber:11},this)," Create new customer"]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:23,columnNumber:9},this),actionButtons:e.jsxDEV(E,{asChild:!0,children:e.jsxDEV(n,{ref:r,type:"button",variant:"secondary",children:"Close"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:29,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:28,columnNumber:9},this),children:e.jsxDEV(j,{defaultValues:{is_active:1},onClose:s,mutation:m},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:35,columnNumber:7},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/create-customer.feature.tsx",lineNumber:19,columnNumber:5},this)}function se(){const[r,s]=_("customer-columns",{defaultValue:J}),[m,i]=l.useState(),o=l.useDeferredValue(m),{customers:u,refetchCustomers:x}=Y(o),f=l.useMemo(()=>W(),[]),t=a=>{i(a.target.value)};return l.useEffect(()=>{x()},[o]),e.jsxDEV("div",{className:"space-y-6 px-4 py-4",children:[e.jsxDEV("div",{className:"flex items-center flex-col lg:flex-row justify-between space-y-2",children:[e.jsxDEV("h2",{className:"text-2xl lg:text-3xl font-bold tracking-tight",children:"Customers"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:45,columnNumber:9},this),e.jsxDEV("div",{className:"flex flex-col md:flex-row items-center gap-2",children:[e.jsxDEV(N,{type:"search",placeholder:"Search customers",value:m,onChange:t},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:49,columnNumber:11},this),e.jsxDEV(re,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:55,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:48,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:44,columnNumber:7},this),e.jsxDEV(S,{data:u,columns:f,columnVisibility:r,rowCount:u==null?void 0:u.length,onColumnVisibilityChange:s,hidePagination:!0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:58,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customers.container.tsx",lineNumber:43,columnNumber:5},this)}function ke(){return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(V,{children:e.jsxDEV("title",{children:"POS System - Customers"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:8,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:7,columnNumber:7},this),e.jsxDEV(se,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:10,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customers.page.tsx",lineNumber:6,columnNumber:5},this)}export{ke as default};
