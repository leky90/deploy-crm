import{a as I,Q as D,r as o,j as r,e as K,R as k}from"./index-XwE6gQmn.js";import{z as $,u as Q,t as Y,F as w}from"./index-MxbznExh.js";import{$ as X,a as F,_ as E,d as O,B as S}from"./button-C4HOWXLM.js";import{u as P}from"./useMutation-Czv1wBp1.js";import{a as U}from"./Helmet-DUuvCvTm.js";import{c as G}from"./convert-data-to-form-data.util-CYcIkezp.js";import{$ as V,a as W,d as R,e as Z}from"./Combination-WE48jzIv.js";import{$ as J,a as ee}from"./index-CROUqNK7.js";import{g as re}from"./react-icons.esm-5SUvy-NO.js";import{L as n}from"./label-DhoCOihp.js";import{u as te}from"./use-cancel-order.mutation-CIf40CLb.js";import{I as A}from"./input-BFqvYdSA.js";import{M as T,A as M}from"./upload.constant-D3d5R5uO.js";import{f as v}from"./format-currency-DwwnROlR.js";import{f as ae}from"./format-percent-Ca7gawAv.js";import{A as oe,a as se,b as ne,c as ce,d as de,e as ie,f as le,g as me,h as ue}from"./alert-dialog-BeURQn3I.js";function pe(e){const t=G(e);return U({method:"post",url:"/customer_history/order_step2",data:t,headers:{"Content-Type":"multipart/form-data"}})}function fe(){const{mutateAsync:e}=P({mutationFn:pe,onSuccess:t=>{t.status&&I.invalidateQueries({queryKey:D.CUSTOMER_HISTORY})}});return{mutationCreateOrderStep2:e}}const H="Checkbox",[be,Be]=V(H),[he,xe]=be(H),ge=o.forwardRef((e,t)=>{const{__scopeCheckbox:a,name:i,checked:l,defaultChecked:c,required:m,disabled:u,value:p="on",onCheckedChange:g,...C}=e,[s,f]=o.useState(null),h=X(t,d=>f(d)),y=o.useRef(!1),N=s?!!s.closest("form"):!0,[x=!1,j]=W({prop:l,defaultProp:c,onChange:g}),z=o.useRef(x);return o.useEffect(()=>{const d=s==null?void 0:s.form;if(d){const _=()=>j(z.current);return d.addEventListener("reset",_),()=>d.removeEventListener("reset",_)}},[s,j]),o.createElement(he,{scope:a,state:x,disabled:u},o.createElement(F.button,E({type:"button",role:"checkbox","aria-checked":b(x)?"mixed":x,"aria-required":m,"data-state":q(x),"data-disabled":u?"":void 0,disabled:u,value:p},C,{ref:h,onKeyDown:R(e.onKeyDown,d=>{d.key==="Enter"&&d.preventDefault()}),onClick:R(e.onClick,d=>{j(_=>b(_)?!0:!_),N&&(y.current=d.isPropagationStopped(),y.current||d.stopPropagation())})})),N&&o.createElement($e,{control:s,bubbles:!y.current,name:i,value:p,checked:x,required:m,disabled:u,style:{transform:"translateX(-100%)"}}))}),_e="CheckboxIndicator",Ce=o.forwardRef((e,t)=>{const{__scopeCheckbox:a,forceMount:i,...l}=e,c=xe(_e,a);return o.createElement(Z,{present:i||b(c.state)||c.state===!0},o.createElement(F.span,E({"data-state":q(c.state),"data-disabled":c.disabled?"":void 0},l,{ref:t,style:{pointerEvents:"none",...e.style}})))}),$e=e=>{const{control:t,checked:a,bubbles:i=!0,...l}=e,c=o.useRef(null),m=J(a),u=ee(t);return o.useEffect(()=>{const p=c.current,g=window.HTMLInputElement.prototype,s=Object.getOwnPropertyDescriptor(g,"checked").set;if(m!==a&&s){const f=new Event("click",{bubbles:i});p.indeterminate=b(a),s.call(p,b(a)?!1:a),p.dispatchEvent(f)}},[m,a,i]),o.createElement("input",E({type:"checkbox","aria-hidden":!0,defaultChecked:b(a)?!1:a},l,{tabIndex:-1,ref:c,style:{...e.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function b(e){return e==="indeterminate"}function q(e){return b(e)?"indeterminate":e?"checked":"unchecked"}const B=ge,ye=Ce,L=o.forwardRef(({className:e,...t},a)=>r.jsx(B,{ref:a,className:O("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:r.jsx(ye,{className:O("flex items-center justify-center text-current"),children:r.jsx(re,{className:"h-4 w-4"})})}));L.displayName=B.displayName;function je(e){return U({method:"post",url:"/customer_history/order_step2_1",data:e})}function ke(){const{mutateAsync:e}=P({mutationFn:je,onSuccess:t=>{t.status&&I.invalidateQueries({queryKey:D.CUSTOMER_HISTORY})}});return{mutationCreateOrderStep2_1:e}}const ve=$.object({uuid_id:$.string({required_error:"Required."}),images_creditcard_due_withdrawn:$.any().refine(e=>{var t;return!(e!=null&&e.length)||!((t=Array.from(e))!=null&&t.some(a=>a.size>T))},"Max file size is 5MB.").refine(e=>{var t;return!(e!=null&&e.length)||!((t=Array.from(e))!=null&&t.some(a=>!M.includes(a.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional(),images_transfer_money_to_customer:$.any().refine(e=>{var t;return!(e!=null&&e.length)||!((t=Array.from(e))!=null&&t.some(a=>a.size>T))},"Max file size is 5MB.").refine(e=>{var t;return!(e!=null&&e.length)||!((t=Array.from(e))!=null&&t.some(a=>!M.includes(a.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional()});function Le({resultStep1:e}){const t=K(),[a,i]=o.useState(!1),{register:l,handleSubmit:c,formState:{errors:m}}=Q({defaultValues:{uuid_id:e.uuid_id},resolver:Y(ve)}),{mutationCreateOrderStep2:u}=fe();ke();const{mutationCancelOrder:p}=te(),g=async f=>{let h=null;a?t(k.CUSTOMER_HISTORIES):h=await u(f),h!=null&&h.status&&t(k.CUSTOMER_HISTORIES)},C=async()=>{(await p({uuid_id:e.uuid_id})).status&&t(k.CUSTOMER_HISTORIES)},s=f=>{i(f)};return r.jsxs("form",{onSubmit:c(g),className:"grid grid-cols-2 gap-4 max-w-2xl mx-auto",autoComplete:"off",children:[r.jsxs("div",{className:"grid border border-b-0 md:grid-cols-[200px_1fr] col-span-2",children:[r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Card Type"}),r.jsx("p",{className:"border-b border-l p-2",children:e.card_type}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Card Number"}),r.jsx("p",{className:"border-b border-l p-2",children:e.customer_creditcard}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Customer Name"}),r.jsx("p",{className:"border-b border-l p-2",children:e.customer_name}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Fee"}),r.jsx("p",{className:"border-b border-l p-2",children:v(e.fee)}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Total Money (- Fee)"}),r.jsx("p",{className:"border-b border-l p-2",children:v(e.money_applied_percent)}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Total Money"}),r.jsx("p",{className:"border-b border-l p-2",children:v(e.money_total)}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Note"}),r.jsx("p",{className:"border-b border-l p-2",children:e.note}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Percent to Charge"}),r.jsx("p",{className:"border-b border-l p-2",children:ae(e.percent_to_charge/100)}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"Rate Option"}),r.jsx("p",{className:"border-b border-l p-2",children:e.rate_option}),r.jsx(n,{className:"text-muted-foreground border-b flex items-center p-2",children:"User Option"}),r.jsx("p",{className:"border-b border-l p-2",children:e.user_option})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(L,{checked:a,onCheckedChange:s,id:"upload-later"}),r.jsx("label",{htmlFor:"upload-later",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Upload later"})]}),!a&&r.jsxs("div",{className:"grid col-span-2 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx(n,{htmlFor:"images_creditcard_due_withdrawn",children:"Credit card Due/Withdrawn images"}),r.jsx(A,{type:"file",multiple:!0,accept:".gif, .jpg, .jpeg, .png, .pdf",...l("images_creditcard_due_withdrawn")}),r.jsx(w,{error:m.images_creditcard_due_withdrawn})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(n,{htmlFor:"images_transfer_money_to_customer",children:"Transfer money to customer images"}),r.jsx(A,{type:"file",multiple:!0,accept:".gif, .jpg, .jpeg, .png, .pdf",...l("images_transfer_money_to_customer")}),r.jsx(w,{error:m.images_transfer_money_to_customer})]})]}),r.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4 col-span-2",children:[r.jsxs(oe,{children:[r.jsx(se,{asChild:!0,children:r.jsx(S,{type:"button",variant:"destructive",children:"Cancel Order"})}),r.jsxs(ne,{children:[r.jsxs(ce,{children:[r.jsx(de,{children:"Are you absolutely sure?"}),r.jsx(ie,{children:"This action cannot be undone. This will permanently cancel this order and can not revert."})]}),r.jsxs(le,{children:[r.jsx(me,{children:"Cancel"}),r.jsx(ue,{variant:"default",onClick:C,children:"Confirm"})]})]})]}),r.jsx(S,{type:"submit",className:"w-full",children:"Submit"})]})]})}export{Le as F};
