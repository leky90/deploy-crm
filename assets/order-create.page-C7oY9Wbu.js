import{a as A,Q as I,r as l,j as e,c as ke,R as z}from"./index-iY8wkAMF.js";import{H as Ee}from"./Helmet-CGO9PIu9.js";import{z as n,u as J,t as ee,F as y}from"./index-CTvMRqQ-.js";import{B as re}from"./button-C2YC4vcZ.js";import{C as Te,c as Pe}from"./card-b4mujOqL.js";import{I as g}from"./input-AzLY8oOf.js";import{L as m}from"./label-By2TmoQV.js";import{T as De}from"./textarea-bKxVxEvm.js";import{u as je,a as Ue,F as Ve,b as Ce,c as Se,d as $e,e as Re,f as Oe,A as qe,g as Fe,h as we,i as Me,j as Ae,k as Ie,l as Be,m as He,n as Le}from"./alert-dialog-D-XwbPZK.js";import{u as Qe}from"./use-auth.cache-BXmm1xjT.js";import{u as B}from"./useMutation-BrvlRgAP.js";import{a as H}from"./api-client-vqFb5rA2.js";import{u as Ke}from"./use-get-customers.query-BNUvp_e9.js";import{F as ze}from"./vn-bank.field-C6kNF2bu.js";import{u as Ye}from"./use-get-customer-ccs.query-BAPm6SiN.js";import{u as Ge}from"./use-get-customer-by-id.query-Cd87UTnt.js";import{u as Y}from"./index-iC2c6L0c.js";import{f as O}from"./format-currency-DwwnROlR.js";import{c as Xe}from"./convert-data-to-form-data.util-CYcIkezp.js";import{$ as We,a as se,_ as L,d as G}from"./index-Bi7vddj2.js";import{$ as Ze,a as Je,d as X,e as er}from"./Combination-Dlom6zUs.js";import{b as rr,d as sr}from"./index-Dax93bta.js";import{f as or}from"./react-icons.esm-BEn0DA9k.js";import{M as W,A as Z}from"./upload.constant-D3d5R5uO.js";import{f as tr}from"./format-percent-Ca7gawAv.js";import"./select-CmovXi16.js";import"./useQuery-GJg87iXi.js";import"./index-f67wLNBR.js";import"./use-get-user-options.query-DxodUnzE.js";import"./index-C65_wQcw.js";import"./use-get-vn-banks.query-BM5CMNTl.js";import"./popover-r12JPl04.js";import"./dialog-D7u3yXXg.js";function ir(r){return H({method:"post",url:"/customer_history/order_step1",data:r})}function mr(){const{mutateAsync:r}=B({mutationFn:ir,onSuccess:t=>{t.status&&A.invalidateQueries({queryKey:I.CUSTOMER_HISTORY})}});return{mutationCreateOrderStep1:r}}const cr=n.object({card_type:n.string({required_error:"Required."}),user_option:n.coerce.number({required_error:"Required."}).gt(0,"Required."),rate_option:n.coerce.number({required_error:"Required."}).gt(0,"Required."),id_customer_info:n.coerce.number({required_error:"Required."}).gt(0,"Required."),id_pos_info:n.coerce.number({required_error:"Required."}).gt(0,"Required."),id_customer_creditcard:n.coerce.number({required_error:"Required."}).gt(0,"Required."),id_users:n.coerce.number({required_error:"Required."}).gt(0,"Required."),id_vietnamese_bank:n.coerce.number({required_error:"Required."}).gt(0,"Required."),days_coming_due:n.coerce.number({required_error:"Required."}),percent_to_charge:n.coerce.number({required_error:"Required."}).gt(0,"Required."),money_total:n.coerce.number({required_error:"Required."}).gt(0,"Required."),money_applied_percent:n.coerce.number({required_error:"Required."}).gt(0,"Required."),note:n.string()});function lr({nextStep:r}){const{auth:t}=Qe(),[o,h]=l.useState("customer"),[f,d]=l.useState(),[x,E]=l.useState(),[u,T]=l.useState(),[c,a]=l.useState(),[P,_]=l.useState(),[v,R]=l.useState(),[j,V]=l.useState(""),[q,N]=l.useState("1"),{register:i,handleSubmit:ce,getValues:C,reset:Q,formState:{errors:k}}=J({defaultValues:{days_coming_due:30,id_customer_creditcard:0,id_customer_info:0,id_pos_info:0,id_vietnamese_bank:0,money_applied_percent:"",money_total:"",note:"",percent_to_charge:0,rate_option:2,user_option:2,id_users:t==null?void 0:t.id},resolver:ee(cr)}),{mutationCalculateManual:le}=je(),{mutationCalculateByLevelRate:ue}=Ue(),{mutationCreateOrderStep1:ne}=mr(),ae=async s=>{const b=await ne(s);b.status&&r&&r(b)},{customers:F,refetchCustomers:de}=Ke(f),{customer:D}=Ge(x),{customerCcs:w,refetchCustomerCcs:pe}=Ye(f),fe=s=>{d(s.target.value)},be=s=>{d(""),Q(),T(void 0),_(void 0),a(void 0),i("id_customer_info").onChange({target:{name:"id_customer_info",value:s.id}}),T(s)},he=s=>{d(""),Q(),T(void 0),_(void 0),i("id_customer_info").onChange({target:{name:"id_customer_info",value:s.id_customer_info}}),i("id_customer_creditcard").onChange({target:{name:"id_customer_creditcard",value:s.id}}),a(s),E(s.id_customer_info)};async function M(s){const b=C("money_total"),S=C("rate_option"),$=C("percent_to_charge");let p={status:!1,fee:0,rate:$,result:0};s&&s==="2"||!s&&S===2?p=await ue({money_total:b}):$>0&&(p=await le({money_total:b,percent_to_charge:String($)})),p!=null&&p.status&&(R(p==null?void 0:p.fee),V(String(p==null?void 0:p.rate)),i("percent_to_charge").onChange({target:{name:"percent_to_charge",value:String(p==null?void 0:p.rate)}}),i("money_applied_percent").onChange({target:{name:"money_applied_percent",value:String(p.result)}}))}const K=s=>{var S;const b=(S=u==null?void 0:u.list_credit_card)==null?void 0:S.find($=>$.id===Number(s));a(b),i("id_vietnamese_bank").onChange({target:{name:"id_vietnamese_bank",value:b==null?void 0:b.id_vietnamese_bank}})},Ne=s=>{_(s)},ye=s=>{N(s),M(s)},ge=s=>{i("money_total").onChange(s),M()},xe=s=>{i("percent_to_charge").onChange(s),V(s.target.value)},_e=()=>M();Y(()=>{o==="customer"?de():pe()},[f,o]),Y(()=>{var s;if(D&&o==="credit_card"){D.list_credit_card=D==null?void 0:D.list_customer_creditcard,T(D);const b=(s=u==null?void 0:u.list_credit_card)==null?void 0:s.find(S=>S.id===Number(c==null?void 0:c.id));i("id_vietnamese_bank").onChange({target:{name:"id_vietnamese_bank",value:b==null?void 0:b.id_vietnamese_bank}})}},[D==null?void 0:D.id,c==null?void 0:c.id,o,K]);const ve=o==="customer"?"Name or Phone":"Credit card number";return e.jsxDEV("form",{onSubmit:ce(ae),className:"grid grid-cols-1 lg:grid-cols-2 gap-4",autoComplete:"off",children:[e.jsxDEV("div",{className:"grid grid-cols-2 lg:col-span-2",children:[e.jsxDEV("div",{children:e.jsxDEV(m,{className:"items-center flex gap-1",children:[e.jsxDEV("input",{name:"searchBy",type:"radio",value:"customer",checked:o==="customer",onChange:()=>h("customer")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:270,columnNumber:13},this)," ","Search by Customer"]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:269,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:268,columnNumber:9},this),e.jsxDEV("div",{children:e.jsxDEV(m,{className:"items-center flex gap-1",children:[e.jsxDEV("input",{name:"searchBy",type:"radio",value:"credit_card",checked:o==="credit_card",onChange:()=>h("credit_card")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:282,columnNumber:13},this)," ","Search by Credit card"]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:281,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:280,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:267,columnNumber:7},this),e.jsxDEV("div",{className:"lg:col-span-2 relative",children:[e.jsxDEV(g,{placeholder:ve,value:f,onChange:fe},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:295,columnNumber:9},this),f&&e.jsxDEV(Te,{className:"absolute top-full mt-2 left-0 w-full",children:e.jsxDEV(Pe,{className:"max-h-80 p-2 overflow-auto",children:[o==="credit_card"&&(w==null?void 0:w.map(s=>e.jsxDEV("div",{className:"flex items-center gap-2 hover:bg-muted p-1 px-2 cursor-pointer",onClick:()=>he(s),children:[e.jsxDEV("strong",{children:s.name_on_creditcard},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:306,columnNumber:21},this)," (",s.creditcard_number,")"]},s.id,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:301,columnNumber:19},this))),o==="customer"&&(F==null?void 0:F.map(s=>e.jsxDEV("div",{className:"flex items-center gap-2 hover:bg-muted p-1 px-2 cursor-pointer",onClick:()=>be(s),children:[e.jsxDEV("strong",{children:s.full_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:317,columnNumber:21},this)," (",s.phonenumber,")"]},s.id,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:312,columnNumber:19},this)))]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:298,columnNumber:13},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:297,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:294,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"customer",children:"Customer full name"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:327,columnNumber:9},this),e.jsxDEV(g,{readOnly:!0,defaultValue:u==null?void 0:u.full_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:328,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:326,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"id_customer_creditcard",children:"Credit Card"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:332,columnNumber:9},this),u?e.jsxDEV(Ve,{...i("id_customer_creditcard"),value:c!=null&&c.id?String(c==null?void 0:c.id):"",listCustomerCreditcards:u==null?void 0:u.list_credit_card,onSelectCard:K},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:334,columnNumber:11},this):e.jsxDEV(g,{readOnly:!0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:341,columnNumber:11},this),e.jsxDEV(y,{error:k.id_customer_creditcard},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:343,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:331,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"id_pos_info",children:"POS"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:347,columnNumber:9},this),c?e.jsxDEV(Ce,{...i("id_pos_info"),idCustomerCreditcard:c==null?void 0:c.id,onSelectPos:Ne},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:349,columnNumber:11},this):e.jsxDEV(g,{readOnly:!0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:355,columnNumber:11},this),e.jsxDEV(y,{error:k.id_pos_info},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:357,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:346,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"id_vietnamese_bank",children:"Bank"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:361,columnNumber:9},this),c?e.jsxDEV(ze,{name:i("id_vietnamese_bank").name,onChange:i("id_vietnamese_bank").onChange,onBlur:i("id_vietnamese_bank").onBlur,readOnly:!0,defaultValue:c!=null&&c.id_vietnamese_bank?String(c.id_vietnamese_bank):void 0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:363,columnNumber:11},this):e.jsxDEV(g,{readOnly:!0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:375,columnNumber:11},this),e.jsxDEV(y,{error:k.id_vietnamese_bank},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:377,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:360,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"money_total",children:"Total Money"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:381,columnNumber:9},this),e.jsxDEV("div",{children:[e.jsxDEV(g,{...i("money_total"),onChange:ge},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:383,columnNumber:11},this),e.jsxDEV("p",{className:"p-2 text-sm italic",children:isNaN(Number(C("money_total")))?" ":O(Number(C("money_total")))},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:384,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:382,columnNumber:9},this),e.jsxDEV(y,{error:k.money_total},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:390,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:380,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"customer",children:"Max Usage Money"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:394,columnNumber:9},this),e.jsxDEV(g,{readOnly:!0,defaultValue:P==null?void 0:P.max_per_charge},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:395,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:393,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"user_option",children:"User Option"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:399,columnNumber:9},this),e.jsxDEV(Se,{...i("user_option"),defaultValue:"2"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:400,columnNumber:9},this),e.jsxDEV(y,{error:k.user_option},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:401,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:398,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"rate_option",children:"Rate Option"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:405,columnNumber:9},this),e.jsxDEV($e,{...i("rate_option"),defaultValue:"2",onSelectRate:ye},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:406,columnNumber:9},this),e.jsxDEV(y,{error:k.rate_option},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:411,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:404,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"percent_to_charge",children:"Percent to Charge"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:415,columnNumber:9},this),e.jsxDEV(g,{...i("percent_to_charge"),value:j,onChange:xe,onBlur:_e,readOnly:q==="2"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:416,columnNumber:9},this),e.jsxDEV(y,{error:k.percent_to_charge},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:423,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:414,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"fee",children:"Fee"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:427,columnNumber:9},this),e.jsxDEV(g,{readOnly:!0,value:v},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:428,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:426,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"money_applied_percent",children:"Total Money Applied Percent"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:432,columnNumber:9},this),e.jsxDEV(g,{...i("money_applied_percent"),value:C("money_applied_percent"),readOnly:!0},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:435,columnNumber:9},this),e.jsxDEV(y,{error:k.money_applied_percent},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:440,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:431,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"days_coming_due",children:"Days Coming Due"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:444,columnNumber:9},this),e.jsxDEV(g,{...i("days_coming_due")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:445,columnNumber:9},this),e.jsxDEV(y,{error:k.days_coming_due},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:446,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:443,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"card_type",children:"Card Type"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:450,columnNumber:9},this),e.jsxDEV(Re,{...i("card_type")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:451,columnNumber:9},this),e.jsxDEV(y,{error:k.card_type},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:452,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:449,columnNumber:7},this),e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] items-center gap-2",children:[e.jsxDEV(m,{htmlFor:"note",children:"Note"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:456,columnNumber:9},this),e.jsxDEV(De,{...i("note")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:457,columnNumber:9},this),e.jsxDEV(y,{error:k.note},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:458,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:455,columnNumber:7},this),e.jsxDEV("div",{className:"lg:col-span-2 mt-4",children:e.jsxDEV(re,{className:"w-full",children:"Submit"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:462,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:461,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-1.form.tsx",lineNumber:262,columnNumber:5},this)}function ur(r){const t=Xe(r);return H({method:"post",url:"/customer_history/order_step2",data:t,headers:{"Content-Type":"multipart/form-data"}})}function nr(){const{mutateAsync:r}=B({mutationFn:ur,onSuccess:t=>{t.status&&A.invalidateQueries({queryKey:I.CUSTOMER_HISTORY})}});return{mutationCreateOrderStep2:r}}const oe="Checkbox",[ar,os]=Ze(oe),[dr,pr]=ar(oe),fr=l.forwardRef((r,t)=>{const{__scopeCheckbox:o,name:h,checked:f,defaultChecked:d,required:x,disabled:E,value:u="on",onCheckedChange:T,...c}=r,[a,P]=l.useState(null),_=We(t,N=>P(N)),v=l.useRef(!1),R=a?!!a.closest("form"):!0,[j=!1,V]=Je({prop:f,defaultProp:d,onChange:T}),q=l.useRef(j);return l.useEffect(()=>{const N=a==null?void 0:a.form;if(N){const i=()=>V(q.current);return N.addEventListener("reset",i),()=>N.removeEventListener("reset",i)}},[a,V]),l.createElement(dr,{scope:o,state:j,disabled:E},l.createElement(se.button,L({type:"button",role:"checkbox","aria-checked":U(j)?"mixed":j,"aria-required":x,"data-state":te(j),"data-disabled":E?"":void 0,disabled:E,value:u},c,{ref:_,onKeyDown:X(r.onKeyDown,N=>{N.key==="Enter"&&N.preventDefault()}),onClick:X(r.onClick,N=>{V(i=>U(i)?!0:!i),R&&(v.current=N.isPropagationStopped(),v.current||N.stopPropagation())})})),R&&l.createElement(Nr,{control:a,bubbles:!v.current,name:h,value:u,checked:j,required:x,disabled:E,style:{transform:"translateX(-100%)"}}))}),br="CheckboxIndicator",hr=l.forwardRef((r,t)=>{const{__scopeCheckbox:o,forceMount:h,...f}=r,d=pr(br,o);return l.createElement(er,{present:h||U(d.state)||d.state===!0},l.createElement(se.span,L({"data-state":te(d.state),"data-disabled":d.disabled?"":void 0},f,{ref:t,style:{pointerEvents:"none",...r.style}})))}),Nr=r=>{const{control:t,checked:o,bubbles:h=!0,...f}=r,d=l.useRef(null),x=rr(o),E=sr(t);return l.useEffect(()=>{const u=d.current,T=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(T,"checked").set;if(x!==o&&a){const P=new Event("click",{bubbles:h});u.indeterminate=U(o),a.call(u,U(o)?!1:o),u.dispatchEvent(P)}},[x,o,h]),l.createElement("input",L({type:"checkbox","aria-hidden":!0,defaultChecked:U(o)?!1:o},f,{tabIndex:-1,ref:d,style:{...r.style,...E,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function U(r){return r==="indeterminate"}function te(r){return U(r)?"indeterminate":r?"checked":"unchecked"}const ie=fr,yr=hr,me=l.forwardRef(({className:r,...t},o)=>e.jsxDEV(ie,{ref:o,className:G("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...t,children:e.jsxDEV(yr,{className:G("flex items-center justify-center text-current"),children:e.jsxDEV(or,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/ui/checkbox.tsx",lineNumber:22,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/ui/checkbox.tsx",lineNumber:19,columnNumber:5},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/ui/checkbox.tsx",lineNumber:11,columnNumber:3},void 0));me.displayName=ie.displayName;function gr(r){return H({method:"post",url:"/customer_history/order_step2_1",data:r})}function xr(){const{mutateAsync:r}=B({mutationFn:gr,onSuccess:t=>{t.status&&A.invalidateQueries({queryKey:I.CUSTOMER_HISTORY})}});return{mutationCreateOrderStep2_1:r}}const _r=n.object({uuid_id:n.string({required_error:"Required."}),images_creditcard_due_withdrawn:n.any().refine(r=>{var t;return!(r!=null&&r.length)||!((t=Array.from(r))!=null&&t.some(o=>o.size>W))},"Max file size is 5MB.").refine(r=>{var t;return!(r!=null&&r.length)||!((t=Array.from(r))!=null&&t.some(o=>!Z.includes(o.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional(),images_transfer_money_to_customer:n.any().refine(r=>{var t;return!(r!=null&&r.length)||!((t=Array.from(r))!=null&&t.some(o=>o.size>W))},"Max file size is 5MB.").refine(r=>{var t;return!(r!=null&&r.length)||!((t=Array.from(r))!=null&&t.some(o=>!Z.includes(o.type)))},".jpg, .jpeg, .png and .webp files are accepted.").optional()});function vr({resultStep1:r}){const t=ke(),[o,h]=l.useState(!1),{register:f,handleSubmit:d,formState:{errors:x}}=J({defaultValues:{uuid_id:r.uuid_id},resolver:ee(_r)}),{mutationCreateOrderStep2:E}=nr(),{mutationCreateOrderStep2_1:u}=xr(),{mutationCancelOrder:T}=Oe(),c=async _=>{let v=null;o?v=await u(_):v=await E(_),v!=null&&v.status&&t(z.CUSTOMER_HISTORIES)},a=async()=>{(await T({uuid_id:r.uuid_id})).status&&t(z.CUSTOMER_HISTORIES)},P=_=>{h(_)};return console.log("errors",x),e.jsxDEV("form",{onSubmit:d(c),className:"grid grid-cols-2 gap-4",autoComplete:"off",children:[e.jsxDEV("div",{className:"grid md:grid-cols-[200px_1fr] gap-4 col-span-2",children:[e.jsxDEV(m,{className:"text-muted-foreground",children:"Card Type"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:86,columnNumber:9},this),e.jsxDEV("p",{children:r.card_type},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:87,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Card Number"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:89,columnNumber:9},this),e.jsxDEV("p",{children:r.customer_creditcard},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:90,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Customer Name"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:92,columnNumber:9},this),e.jsxDEV("p",{children:r.customer_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:93,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Fee"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:95,columnNumber:9},this),e.jsxDEV("p",{children:O(r.fee)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:96,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Total Money (- Fee)"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:98,columnNumber:9},this),e.jsxDEV("p",{children:O(r.money_applied_percent)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:99,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Total Money"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:101,columnNumber:9},this),e.jsxDEV("p",{children:O(r.money_total)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:102,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Note"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:104,columnNumber:9},this),e.jsxDEV("p",{children:r.note},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:105,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Percent to Charge"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:107,columnNumber:9},this),e.jsxDEV("p",{children:tr(r.percent_to_charge/100)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:108,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"Rate Option"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:110,columnNumber:9},this),e.jsxDEV("p",{children:r.rate_option},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:111,columnNumber:9},this),e.jsxDEV(m,{className:"text-muted-foreground",children:"User Option"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:113,columnNumber:9},this),e.jsxDEV("p",{children:r.user_option},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:114,columnNumber:9},this),e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(me,{checked:o,onCheckedChange:P,id:"upload-later"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:117,columnNumber:11},this),e.jsxDEV("label",{htmlFor:"upload-later",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Upload later"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:122,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:116,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:85,columnNumber:7},this),!o&&e.jsxDEV("div",{className:"grid col-span-2 md:grid-cols-2 gap-4",children:[e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(m,{htmlFor:"images_creditcard_due_withdrawn",children:"Credit card Due/Withdrawn images"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:134,columnNumber:13},this),e.jsxDEV(g,{type:"file",multiple:!0,accept:".gif, .jpg, .jpeg, .png, .pdf",...f("images_creditcard_due_withdrawn")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:137,columnNumber:13},this),e.jsxDEV(y,{error:x.images_creditcard_due_withdrawn},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:143,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:133,columnNumber:11},this),e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV(m,{htmlFor:"images_transfer_money_to_customer",children:"Transfer money to customer images"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:149,columnNumber:13},this),e.jsxDEV(g,{type:"file",multiple:!0,accept:".gif, .jpg, .jpeg, .png, .pdf",...f("images_transfer_money_to_customer")},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:152,columnNumber:13},this),e.jsxDEV(y,{error:x.images_transfer_money_to_customer},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:158,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:148,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:132,columnNumber:9},this),e.jsxDEV("div",{className:"mt-4 grid grid-cols-2 gap-4 col-span-2",children:[e.jsxDEV(qe,{children:[e.jsxDEV(Fe,{children:"Cancel Order"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:167,columnNumber:11},this),e.jsxDEV(we,{children:[e.jsxDEV(Me,{children:[e.jsxDEV(Ae,{children:"Are you absolutely sure?"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:170,columnNumber:15},this),e.jsxDEV(Ie,{children:"This action cannot be undone. This will permanently cancel this order and can not revert."},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:171,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:169,columnNumber:13},this),e.jsxDEV(Be,{children:[e.jsxDEV(He,{children:"Cancel"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:177,columnNumber:15},this),e.jsxDEV(Le,{variant:"default",onClick:a,children:"Confirm"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:178,columnNumber:15},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:176,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:168,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:166,columnNumber:9},this),e.jsxDEV(re,{type:"submit",className:"w-full",children:"Submit"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:184,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:165,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/forms/customer-history/order-step-2.form.tsx",lineNumber:80,columnNumber:5},this)}function kr(){const[r,t]=l.useState();function o(h){t(h)}return e.jsxDEV("div",{className:"space-y-4 px-4 mb-10",children:[e.jsxDEV("div",{className:"flex items-center flex-col lg:flex-row justify-between space-y-2",children:e.jsxDEV("h2",{className:"text-2xl lg:text-3xl font-bold tracking-tight",children:"Create Order"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-create.container.tsx",lineNumber:17,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-create.container.tsx",lineNumber:16,columnNumber:7},this),!r&&e.jsxDEV(lr,{nextStep:o},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-create.container.tsx",lineNumber:21,columnNumber:24},this),r&&e.jsxDEV(vr,{resultStep1:r},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-create.container.tsx",lineNumber:22,columnNumber:23},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/order-create.container.tsx",lineNumber:15,columnNumber:5},this)}function ts(){return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Ee,{children:e.jsxDEV("title",{children:"POS System - Order Create"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-create.page.tsx",lineNumber:8,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-create.page.tsx",lineNumber:7,columnNumber:7},this),e.jsxDEV(kr,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-create.page.tsx",lineNumber:10,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/order-create.page.tsx",lineNumber:6,columnNumber:5},this)}export{ts as default};
