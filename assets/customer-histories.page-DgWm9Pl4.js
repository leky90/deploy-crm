import{j as r,R as a,L as d,Q as k,k as E,d as P,r as m}from"./index-B_ytu5vn.js";import{a as T,H as U}from"./Helmet-DkqbKfy8.js";import{e as j,f as C,P as S}from"./react-icons.esm-DmndkTF9.js";import{B as f}from"./button-CGE2OTtm.js";import{u as K,D as I}from"./index-SvRXoSAA.js";import{u as R,a as w}from"./use-get-user-options.query-DeLAAZSv.js";import{u as H}from"./use-get-statuses.query-CUcZUFgR.js";import{u as O}from"./use-get-vn-banks.query-DktlonYl.js";import{B as x}from"./badge-Cp02pa98.js";import{C as p}from"./cell-currency-DmCKOUlf.js";import{C as B}from"./cell-percent-BQfqrDYO.js";import{C as s}from"./cell-text-B_ib4RBF.js";import{C as Q}from"./cell-link-QgHFIAc6.js";import{F}from"./customer-cc-info.feature-JJYTj1rl.js";import{F as G}from"./customer-info.feature-YKPMqzB_.js";import{u as L}from"./useQuery-Ca2VtRxa.js";import{I as A}from"./input-CA_BiuFQ.js";import"./Combination-CkrLVZbR.js";import"./index-D8nAB3w6.js";import"./index-C7tRwe3w.js";import"./select-B0JqYmI4.js";import"./dropdown-menu-BqptXpvu.js";import"./index-CkFd4aZp.js";import"./index-mj6Aafat.js";import"./format-currency-DwwnROlR.js";import"./format-percent-Ca7gawAv.js";import"./label-WR9_UZlh.js";import"./dialog-button.component-HZAuVr2g.js";import"./dialog-BY_S0piy.js";import"./index-pSuU6xnM.js";import"./use-get-customer-cc-by-id.query-Bw4aVvl2.js";import"./get-yes-no.util-C-N_EnQX.js";import"./use-get-customer-by-id.query-BFzWkrdl.js";const M={id:!0,card_type:!0,date_coming_due:!0,date_due:!1,date_withdrawn:!0,days_coming_due:!0,days_remaining_due:!0,fee:!0,id_customer_creditcard:!1,id_customer_info:!1,id_pos_info:!1,id_users:!1,id_vietnamese_bank:!1,images_creditcard_due_withdrawn:!1,images_transfer_money_to_customer:!1,is_bank_payment_complete:!0,last_update:!1,money_applied_percent:!0,money_total:!0,note:!1,percent_to_charge:!0,rate_option:!0,status:!0,time_insert:!1,user_option:!0,uuid_id:!1,tid_pos:!1},z=({userOptions:i,rateOptions:u,statuses:o,vnBanks:t})=>[{id:"select-col",accessorKey:"select-col",enableHiding:!1,enablePinning:!0,header:({table:e})=>r.jsxDEV("input",{type:"checkbox",checked:e.getIsAllRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:70,columnNumber:7},void 0),cell:({row:e})=>r.jsxDEV("input",{type:"checkbox",checked:e.getIsSelected(),disabled:!e.getCanSelect(),onChange:e.getToggleSelectedHandler()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:78,columnNumber:7},void 0)},{id:"id",accessorKey:"id",header:"ID",enableHiding:!1,enablePinning:!0,cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:93,columnNumber:14},void 0)},{accessorKey:"uuid_id",header:"UUID",enablePinning:!1,cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:101,columnNumber:14},void 0)},{accessorKey:"id_users",header:"User ID",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:108,columnNumber:14},void 0)},{accessorKey:"rate_option",header:"Rate option",cell:e=>{var l;return r.jsxDEV(s,{children:(l=u==null?void 0:u[e.getValue()])==null?void 0:l.name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:116,columnNumber:9},void 0)}},{accessorKey:"user_option",header:"User option",cell:e=>{var l;return r.jsxDEV(s,{children:(l=i==null?void 0:i[e.getValue()])==null?void 0:l.name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:125,columnNumber:9},void 0)}},{accessorKey:"status",header:"Status",cell:e=>{var l,n;return r.jsxDEV(x,{variant:(l=o==null?void 0:o[e.getValue()])==null?void 0:l.status,children:(n=o==null?void 0:o[e.getValue()])==null?void 0:n.status},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:134,columnNumber:9},void 0)}},{accessorKey:"id_customer_creditcard",header:"Customer CCID",cell:e=>r.jsxDEV(F,{id:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:146,columnNumber:14},void 0)},{accessorKey:"id_customer_info",header:"Customer Info ID",cell:e=>r.jsxDEV(G,{id:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:153,columnNumber:14},void 0)},{accessorKey:"tid_pos",header:"POS TID",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:160,columnNumber:14},void 0)},{accessorKey:"id_pos_info",header:"POS ID",cell:e=>r.jsxDEV(Q,{to:a.POS_DETAIL.replace(":id",e.getValue()),children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:168,columnNumber:9},void 0)},{accessorKey:"id_vietnamese_bank",header:"Bank Name",cell:e=>{var l;return r.jsxDEV(s,{children:(l=t==null?void 0:t[e.getValue()])==null?void 0:l.short_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:181,columnNumber:9},void 0)}},{accessorKey:"is_bank_payment_complete",header:"Is bank payment complete?",cell:e=>r.jsxDEV(x,{variant:e.getValue()?"success":"destructive",children:e.getValue()?"Đã chuyển":"Chưa chuyển"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:190,columnNumber:9},void 0)},{accessorKey:"date_due",header:"Date due",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:200,columnNumber:14},void 0)},{accessorKey:"date_coming_due",header:"Date coming due",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:207,columnNumber:14},void 0)},{accessorKey:"days_coming_due",header:"Days coming due",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:214,columnNumber:14},void 0)},{accessorKey:"days_remaining_due",header:"Date remaining due",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:221,columnNumber:14},void 0)},{accessorKey:"date_withdrawn",header:"Date withdrawn",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:228,columnNumber:14},void 0)},{accessorKey:"card_type",header:"Card type",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:235,columnNumber:14},void 0)},{accessorKey:"money_total",header:"Revenue",cell:e=>r.jsxDEV(p,{value:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:242,columnNumber:14},void 0)},{accessorKey:"percent_to_charge",header:"Percent to charge",cell:e=>r.jsxDEV(B,{value:e.getValue()/100},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:249,columnNumber:14},void 0)},{accessorKey:"fee",header:"Fee",cell:e=>r.jsxDEV(p,{value:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:256,columnNumber:14},void 0)},{accessorKey:"money_applied_percent",header:"Net profit",cell:e=>r.jsxDEV(p,{value:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:263,columnNumber:14},void 0)},{accessorKey:"note",header:"Note",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:270,columnNumber:14},void 0)},{accessorKey:"last_update",header:"Last update",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:277,columnNumber:14},void 0)},{accessorKey:"time_insert",header:"Created time",cell:e=>r.jsxDEV(s,{children:e.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:284,columnNumber:14},void 0)},{id:"actions",enableHiding:!1,cell:({row:e})=>r.jsxDEV("div",{className:"space-x-2 truncate h-9",children:[e.original.status===3&&r.jsxDEV(d,{to:a.CUSTOMER_HISTORIES_UPDATE.replace(":id",String(e.original.id)),className:"text-primary",children:r.jsxDEV(f,{variant:"outline",size:"icon",children:r.jsxDEV(j,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:302,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:301,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:294,columnNumber:13},void 0),e.original.status===2&&r.jsxDEV(d,{to:a.CUSTOMER_HISTORIES_UPLOAD.replace(":id",String(e.original.id)),className:"text-primary",children:r.jsxDEV(f,{variant:"outline",size:"icon",children:r.jsxDEV(C,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:315,columnNumber:17},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:314,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:307,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/customer-history.column.tsx",lineNumber:292,columnNumber:9},void 0)}];function Y(i){let u="get_all_order_history";return i.keywords&&(u="searchHistory"),T({url:"/customer_history/"+u,params:i})}function q(i){const u=[i.order_by,i.page,i.page_limit,i.keywords].join("_"),{data:o}=L({queryKey:[...k.CUSTOMER_HISTORY,u],queryFn:()=>Y(i),placeholderData:E,gcTime:1e3*10});return{customerHistories:o}}function $(){P();const[i,u]=m.useState(),[o,t]=m.useState({pageIndex:0,pageSize:10}),[e,l]=K("customer-history-columns",{defaultValue:M}),[n,_]=m.useState({}),{customerHistories:c}=q({page:o.pageIndex+1,page_limit:o.pageSize,order_by:"DESC",keywords:i}),{userOptionsByKey:y}=R(),{rateOptionsByKey:b}=w(),{statusesByKey:h}=H(),{vnBanksByKey:N}=O(),V=m.useMemo(()=>z({userOptions:y,rateOptions:b,statuses:h,vnBanks:N}),[y,b,h,N]),v=g=>{u(g.target.value)};function D(){return`https://pos.crawl.vn/customer_history/GetInvoice?id_customer_history=${Object.keys(n).join("-")}`}return r.jsxDEV("div",{className:"space-y-6 px-4 py-4",children:[r.jsxDEV("div",{className:"flex items-center flex-col lg:flex-row justify-between space-y-2",children:[r.jsxDEV("h2",{className:"text-2xl lg:text-3xl font-bold tracking-tight items-center flex gap-2",children:["Customer Histories"," ",Object.keys(n).length>0&&r.jsxDEV(d,{to:D(),target:"_blank",className:"rounded px-2 py-1 border text-sm",children:"Get Invoices"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:82,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:79,columnNumber:9},this),r.jsxDEV("div",{className:"flex items-center flex-col md:flex-row gap-2",children:[r.jsxDEV(A,{type:"search",placeholder:"Search customer histories",value:i,onChange:v,className:"w-80"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:92,columnNumber:11},this),r.jsxDEV(d,{to:a.CUSTOMER_HISTORIES_CREATE,children:r.jsxDEV(f,{className:"gap-2",children:[r.jsxDEV(S,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:101,columnNumber:15},this)," Create new order"]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:100,columnNumber:13},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:99,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:91,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:78,columnNumber:7},this),r.jsxDEV(I,{data:c==null?void 0:c.result,columns:V,columnVisibility:e,rowCount:c==null?void 0:c.total_data,pagination:o,onColumnVisibilityChange:l,onPaginationChange:t,rowSelection:n,onRowSelectionChange:_},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:106,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/customer-histories.container.tsx",lineNumber:77,columnNumber:5},this)}function Ue(){return r.jsxDEV(r.Fragment,{children:[r.jsxDEV(U,{children:r.jsxDEV("title",{children:"POS System - Customer Histories"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customer-histories.page.tsx",lineNumber:8,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customer-histories.page.tsx",lineNumber:7,columnNumber:7},this),r.jsxDEV($,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customer-histories.page.tsx",lineNumber:10,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/customer-histories.page.tsx",lineNumber:6,columnNumber:5},this)}export{Ue as default};
