import{B as d,E as f,r as n,F as h,Q as y,j as e,G as u,H as o,I as k,J as m,K as C,R as E,L as S,M as K,P as v,S as I,T as R,U as b,V as N,W as w,X as F,Y as B,Z as D,a0 as H,a1 as q,a2 as A,a3 as T,a4 as M,a5 as Q}from"./index-CpIRsMsc.js";import{C as P}from"./cell-link-Cozsh1Z8.js";function G(){return d({url:"/customer_history/rate_option"})}function L(){const{data:r}=f({queryKey:y.RATE_OPTIONS,queryFn:G}),i=n.useMemo(()=>r!=null&&r.status?h(r.result,"id"):{},[r==null?void 0:r.status]);return{rateOptions:r==null?void 0:r.result,rateOptionsByKey:i}}function Y(){return d({url:"/customer_history/ListStatus"})}function z(){const{data:r}=f({queryKey:y.STATUSES,queryFn:Y}),i=n.useMemo(()=>r!=null&&r.status?h(r.result,"id"):{},[r==null?void 0:r.status]);return{statuses:r==null?void 0:r.result,statusesByKey:i}}function X(){return d({url:"/customer_history/user_option"})}function J(){const{data:r}=f({queryKey:y.USER_OPTIONS,queryFn:X}),i=n.useMemo(()=>r!=null&&r.status?h(r.result,"id"):{},[r==null?void 0:r.status]);return{userOptions:r==null?void 0:r.result,userOptionsByKey:i}}function W({row:r,userOptions:i,rateOptions:c,statuses:l,vnBanks:s}){return e.jsxDEV("div",{className:"grid grid-cols-2 gap-4 max-h-96 px-4 overflow-auto",children:r.getAllCells().map(a=>{let t=e.jsxDEV(u,{children:a.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:37,columnNumber:25},this);if(a.column.id!=="actions"){switch(a.column.id){case"id_pos_info":t=e.jsxDEV(P,{to:E.STATISTICS_POS_USED.replace(":id",a.getValue()),children:a.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:44,columnNumber:15},this);break;case"id_vietnamese_bank":t=e.jsxDEV(C,{value:a.getValue(),vnBanks:s},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:57,columnNumber:15},this);break;case"status":t=e.jsxDEV(m,{variant:l==null?void 0:l[a.getValue()].status,children:l==null?void 0:l[a.getValue()].status},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:62,columnNumber:15},this);break;case"user_option":t=e.jsxDEV(u,{children:i==null?void 0:i[a.getValue()].name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:73,columnNumber:15},this);break;case"rate_option":t=e.jsxDEV(u,{children:c==null?void 0:c[a.getValue()].name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:78,columnNumber:15},this);break;case"is_bank_payment_complete":t=e.jsxDEV(m,{variant:a.getValue()?"success":"destructive",children:a.getValue()?"Đã chuyển":"Chưa chuyển"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:83,columnNumber:15},this);break;case"percent_to_charge":t=e.jsxDEV(k,{value:a.getValue()/100},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:91,columnNumber:25},this);break;case"money_total":case"money_applied_percent":case"fee":t=e.jsxDEV(o,{value:a.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:96,columnNumber:25},this);break}return e.jsxDEV(n.Fragment,{children:[e.jsxDEV(S,{className:"text-muted-foreground",children:a.column.columnDef.header},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:103,columnNumber:13},this),e.jsxDEV("div",{children:t},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:106,columnNumber:13},this)]},a.id,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:102,columnNumber:11},this)}})},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-info.feature.tsx",lineNumber:35,columnNumber:5},this)}const Z={id:!0,card_type:!0,date_coming_due:!0,date_due:!1,date_withdrawn:!0,days_coming_due:!0,fee:!0,id_customer_creditcard:!1,id_customer_info:!1,id_pos_info:!1,id_users:!1,id_vietnamese_bank:!1,images_creditcard_due_withdrawn:!1,images_transfer_money_to_customer:!1,is_bank_payment_complete:!0,last_update:!1,money_applied_percent:!0,money_total:!0,note:!1,percent_to_charge:!0,rate_option:!0,status:!0,time_insert:!1,user_option:!0,uuid_id:!1,tid_pos:!1},$=({userOptions:r,rateOptions:i,statuses:c,vnBanks:l})=>[{accessorKey:"id",header:"ID",enableHiding:!1,cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:68,columnNumber:14},void 0)},{accessorKey:"uuid_id",header:"UUID",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:75,columnNumber:14},void 0)},{accessorKey:"id_users",header:"User ID",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:82,columnNumber:14},void 0)},{accessorKey:"rate_option",header:"Rate option",cell:s=>e.jsxDEV(u,{children:i==null?void 0:i[s.getValue()].name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:90,columnNumber:9},void 0)},{accessorKey:"user_option",header:"User option",cell:s=>e.jsxDEV(u,{children:r==null?void 0:r[s.getValue()].name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:99,columnNumber:9},void 0)},{accessorKey:"status",header:"Status",cell:s=>e.jsxDEV(m,{variant:c==null?void 0:c[s.getValue()].status,children:c==null?void 0:c[s.getValue()].status},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:108,columnNumber:9},void 0)},{accessorKey:"id_customer_creditcard",header:"Customer CCID",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:120,columnNumber:14},void 0)},{accessorKey:"id_customer_info",header:"Customer info ID",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:127,columnNumber:14},void 0)},{accessorKey:"tid_pos",header:"POS TID",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:134,columnNumber:14},void 0)},{accessorKey:"id_pos_info",header:"POS ID",cell:s=>e.jsxDEV(P,{to:E.STATISTICS_POS_USED.replace(":id",s.getValue()),children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:142,columnNumber:9},void 0)},{accessorKey:"id_vietnamese_bank",header:"VN Bank",cell:s=>e.jsxDEV(u,{children:l==null?void 0:l[s.getValue()].short_name},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:158,columnNumber:9},void 0)},{accessorKey:"is_bank_payment_complete",header:"Is bank payment complete?",cell:s=>e.jsxDEV(m,{variant:s.getValue()?"success":"destructive",children:s.getValue()?"Đã chuyển":"Chưa chuyển"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:167,columnNumber:9},void 0)},{accessorKey:"date_due",header:"Date due",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:177,columnNumber:14},void 0)},{accessorKey:"date_coming_due",header:"Date coming due",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:184,columnNumber:14},void 0)},{accessorKey:"days_coming_due",header:"Days coming due",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:191,columnNumber:14},void 0)},{accessorKey:"date_withdrawn",header:"Date withdrawn",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:198,columnNumber:14},void 0)},{accessorKey:"card_type",header:"Card type",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:206,columnNumber:14},void 0)},{accessorKey:"money_total",header:"Revenue",cell:s=>e.jsxDEV(o,{value:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:213,columnNumber:14},void 0)},{accessorKey:"percent_to_charge",header:"Percent to charge",cell:s=>e.jsxDEV(k,{value:s.getValue()/100},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:220,columnNumber:14},void 0)},{accessorKey:"fee",header:"Fee",cell:s=>e.jsxDEV(o,{value:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:227,columnNumber:14},void 0)},{accessorKey:"money_applied_percent",header:"Net profit",cell:s=>e.jsxDEV(o,{value:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:234,columnNumber:14},void 0)},{accessorKey:"note",header:"Note",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:241,columnNumber:14},void 0)},{accessorKey:"last_update",header:"Last update",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:248,columnNumber:14},void 0)},{accessorKey:"time_insert",header:"Created time",cell:s=>e.jsxDEV(u,{children:s.getValue()},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:255,columnNumber:14},void 0)},{id:"actions",enableHiding:!1,cell:({row:s})=>e.jsxDEV(K,{title:"Detail Info",description:"Detail info's statistic customer history.",className:"max-w-max",trigger:e.jsxDEV(v,{variant:"outline",size:"icon",children:e.jsxDEV(I,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:269,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:268,columnNumber:13},void 0),actionButtons:e.jsxDEV(R,{asChild:!0,children:e.jsxDEV(v,{type:"button",variant:"secondary",children:"Close"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:274,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:273,columnNumber:13},void 0),children:e.jsxDEV(W,{row:s,userOptions:r,rateOptions:i,statuses:c,vnBanks:l},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:280,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/columns/statistic-customer-history.column.tsx",lineNumber:263,columnNumber:9},void 0)}];function O({totalRevenue:r,totalNetProfit:i,totalFee:c}){return e.jsxDEV("div",{className:"grid grid-cols-3 gap-8",children:[e.jsxDEV(b,{label:"Total Revenue",value:N(r)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-cards.feature.tsx",lineNumber:17,columnNumber:7},this),e.jsxDEV(b,{label:"Total Net Profit",value:N(i)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-cards.feature.tsx",lineNumber:22,columnNumber:7},this),e.jsxDEV(b,{label:"Total Fee",value:N(c)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-cards.feature.tsx",lineNumber:27,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/features/statistic-customer-history-cards.feature.tsx",lineNumber:16,columnNumber:5},this)}function ee(r){return d({url:"/statistics/Get_Customer_History_By_Date",params:r})}function se(r){const i=["BY_DATE",r._from,r._to,r.page,r.page_limit].join("_"),{data:c,refetch:l}=f({queryKey:[...y.CUSTOMER_HISTORY,i],queryFn:()=>ee(r),placeholderData:w,gcTime:1e3*10});return{customerHistoryByDate:c,refetchCustomerHistoryByDate:l}}function re(){const[r,i]=n.useState({from:F(30),to:B()}),[c,l]=n.useState({pageIndex:0,pageSize:10}),[s,a]=n.useState(Z),{customerHistoryByDate:t}=se({_from:D(r.from||new Date,T),_to:D(r.to||new Date,T),page:c.pageIndex+1,page_limit:c.pageSize}),{userOptionsByKey:p}=J(),{rateOptionsByKey:g}=L(),{statusesByKey:x}=z(),{vnBanksByKey:_}=H(),U=n.useMemo(()=>$({userOptions:p,rateOptions:g,statuses:x,vnBanks:_}),[p,g,x,_]),j=(V,...te)=>{V&&i(V)};return e.jsxDEV("div",{className:"space-y-6 px-4 py-4",children:[e.jsxDEV("div",{className:"flex items-center justify-between space-y-2",children:[e.jsxDEV("h2",{className:"text-3xl font-bold tracking-tight",children:"Statistic Customer History"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/statistic-customer-history.container.tsx",lineNumber:67,columnNumber:9},this),e.jsxDEV("div",{className:"flex items-center space-x-2",children:e.jsxDEV(q,{date:r,onSelect:j},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/statistic-customer-history.container.tsx",lineNumber:71,columnNumber:11},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/statistic-customer-history.container.tsx",lineNumber:70,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/statistic-customer-history.container.tsx",lineNumber:66,columnNumber:7},this),e.jsxDEV(O,{totalRevenue:t==null?void 0:t.money_total_in_date,totalNetProfit:t==null?void 0:t.money_applied_percent_in_date,totalFee:t==null?void 0:t.fee_in_date},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/statistic-customer-history.container.tsx",lineNumber:74,columnNumber:7},this),e.jsxDEV(A,{data:t==null?void 0:t.result,columns:U,columnVisibility:s,rowCount:t==null?void 0:t.total_data,pagination:c,onColumnVisibilityChange:a,onPaginationChange:l},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/statistic-customer-history.container.tsx",lineNumber:79,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/containers/statistic-customer-history.container.tsx",lineNumber:65,columnNumber:5},this)}function ce(){return e.jsxDEV(M,{type:"admin",children:[e.jsxDEV(Q,{children:e.jsxDEV("title",{children:"CRM - Statistic Customer History"},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/statistic-customer-history.page.tsx",lineNumber:9,columnNumber:9},this)},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/statistic-customer-history.page.tsx",lineNumber:8,columnNumber:7},this),e.jsxDEV(re,{},void 0,!1,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/statistic-customer-history.page.tsx",lineNumber:11,columnNumber:7},this)]},void 0,!0,{fileName:"/Users/ldky90/Public/Training/crm/src/app/modules/customer/pages/statistic-customer-history.page.tsx",lineNumber:7,columnNumber:5},this)}export{ce as default};
