import{j as t,R as d,L as m,Q as I,k as b,d as v,r as u}from"./index-XwE6gQmn.js";import{a as k,H as D}from"./Helmet-DUuvCvTm.js";import{e as R,f as w,P as E}from"./react-icons.esm-5SUvy-NO.js";import{B as h}from"./button-C4HOWXLM.js";import{u as H,D as P}from"./index-BsOMOp0z.js";import{u as T,a as U}from"./use-get-user-options.query-B2W5Dekj.js";import{u as N}from"./use-get-statuses.query-C8V2J_-G.js";import{u as O}from"./use-get-vn-banks.query-F2BXTXzV.js";import{B as j}from"./badge-DmV7fwsG.js";import{C as g}from"./cell-currency-D6tOSgAE.js";import{C as B}from"./cell-percent-DV96QzFN.js";import{C as r}from"./cell-text-H3JibL2T.js";import{C as Q}from"./cell-link-Dxt7hr8a.js";import{F}from"./customer-cc-info.feature-mi_TeN3z.js";import{F as G}from"./customer-info.feature-Dk8ocKy_.js";import{u as L}from"./useQuery-BXJOiSOe.js";import{I as A}from"./input-BFqvYdSA.js";import"./Combination-WE48jzIv.js";import"./index-DWR91OCR.js";import"./index-CROUqNK7.js";import"./select-BLsJIQQv.js";import"./dropdown-menu-oMbE38VB.js";import"./index-Dwx9NaXw.js";import"./index-CwCgg0f3.js";import"./format-currency-DwwnROlR.js";import"./format-percent-Ca7gawAv.js";import"./label-DhoCOihp.js";import"./dialog-button.component-msJRMg9P.js";import"./dialog-Cq2VxrqT.js";import"./index-DrW2nO8L.js";import"./use-get-customer-cc-by-id.query-ajBfmNNj.js";import"./get-yes-no.util-C-N_EnQX.js";import"./use-get-customer-by-id.query-lOxLSuWh.js";const M={id:!0,card_type:!0,date_coming_due:!0,date_due:!1,date_withdrawn:!0,days_coming_due:!0,days_remaining_due:!0,fee:!0,id_customer_creditcard:!1,id_customer_info:!1,id_pos_info:!1,id_users:!1,id_vietnamese_bank:!1,images_creditcard_due_withdrawn:!1,images_transfer_money_to_customer:!1,is_bank_payment_complete:!0,last_update:!1,money_applied_percent:!0,money_total:!0,note:!1,percent_to_charge:!0,rate_option:!0,status:!0,time_insert:!1,user_option:!0,uuid_id:!1,tid_pos:!1},z=({userOptions:a,rateOptions:o,statuses:i,vnBanks:c})=>[{id:"select-col",accessorKey:"select-col",enableHiding:!1,enablePinning:!0,header:({table:e})=>t.jsx("input",{type:"checkbox",checked:e.getIsAllRowsSelected(),onChange:e.getToggleAllRowsSelectedHandler()}),cell:({row:e})=>t.jsx("input",{type:"checkbox",checked:e.getIsSelected(),disabled:!e.getCanSelect(),onChange:e.getToggleSelectedHandler()})},{id:"id",accessorKey:"id",header:"ID",enableHiding:!1,enablePinning:!0,cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"uuid_id",header:"UUID",enablePinning:!1,cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"id_users",header:"User ID",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"rate_option",header:"Rate option",cell:e=>{var s;return t.jsx(r,{children:(s=o==null?void 0:o[e.getValue()])==null?void 0:s.name})}},{accessorKey:"user_option",header:"User option",cell:e=>{var s;return t.jsx(r,{children:(s=a==null?void 0:a[e.getValue()])==null?void 0:s.name})}},{accessorKey:"status",header:"Status",cell:e=>{var s,n;return t.jsx(j,{variant:(s=i==null?void 0:i[e.getValue()])==null?void 0:s.status,children:(n=i==null?void 0:i[e.getValue()])==null?void 0:n.status})}},{accessorKey:"id_customer_creditcard",header:"Customer CCID",cell:e=>t.jsx(F,{id:e.getValue()})},{accessorKey:"id_customer_info",header:"Customer Info ID",cell:e=>t.jsx(G,{id:e.getValue()})},{accessorKey:"tid_pos",header:"POS TID",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"id_pos_info",header:"POS ID",cell:e=>t.jsx(Q,{to:d.POS_DETAIL.replace(":id",e.getValue()),children:e.getValue()})},{accessorKey:"id_vietnamese_bank",header:"Bank Name",cell:e=>{var s;return t.jsx(r,{children:(s=c==null?void 0:c[e.getValue()])==null?void 0:s.short_name})}},{accessorKey:"is_bank_payment_complete",header:"Is bank payment complete?",cell:e=>t.jsx(j,{variant:e.getValue()?"success":"destructive",children:e.getValue()?"Đã chuyển":"Chưa chuyển"})},{accessorKey:"date_due",header:"Date due",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"date_coming_due",header:"Date coming due",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"days_coming_due",header:"Days coming due",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"days_remaining_due",header:"Date remaining due",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"date_withdrawn",header:"Date withdrawn",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"card_type",header:"Card type",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"money_total",header:"Revenue",cell:e=>t.jsx(g,{value:e.getValue()})},{accessorKey:"percent_to_charge",header:"Percent to charge",cell:e=>t.jsx(B,{value:e.getValue()/100})},{accessorKey:"fee",header:"Fee",cell:e=>t.jsx(g,{value:e.getValue()})},{accessorKey:"money_applied_percent",header:"Net profit",cell:e=>t.jsx(g,{value:e.getValue()})},{accessorKey:"note",header:"Note",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"last_update",header:"Last update",cell:e=>t.jsx(r,{children:e.getValue()})},{accessorKey:"time_insert",header:"Created time",cell:e=>t.jsx(r,{children:e.getValue()})},{id:"actions",enableHiding:!1,cell:({row:e})=>t.jsxs("div",{className:"space-x-2 truncate h-9",children:[e.original.status===3&&t.jsx(m,{to:d.CUSTOMER_HISTORIES_UPDATE.replace(":id",String(e.original.id)),className:"text-primary",children:t.jsx(h,{variant:"outline",size:"icon",children:t.jsx(R,{})})}),e.original.status===2&&t.jsx(m,{to:d.CUSTOMER_HISTORIES_UPLOAD.replace(":id",String(e.original.id)),className:"text-primary",children:t.jsx(h,{variant:"outline",size:"icon",children:t.jsx(w,{})})})]})}];function Y(a){let o="get_all_order_history";return a.keywords&&(o="searchHistory"),k({url:"/customer_history/"+o,params:a})}function q(a){const o=[a.order_by,a.page,a.page_limit,a.keywords].join("_"),{data:i}=L({queryKey:[...I.CUSTOMER_HISTORY,o],queryFn:()=>Y(a),placeholderData:b,gcTime:1e3*10});return{customerHistories:i}}function $(){v();const[a,o]=u.useState(),[i,c]=u.useState({pageIndex:0,pageSize:10}),[e,s]=H("customer-history-columns",{defaultValue:M}),[n,C]=u.useState({}),{customerHistories:l}=q({page:i.pageIndex+1,page_limit:i.pageSize,order_by:"DESC",keywords:a}),{userOptionsByKey:p}=T(),{rateOptionsByKey:_}=U(),{statusesByKey:y}=N(),{vnBanksByKey:x}=O(),S=u.useMemo(()=>z({userOptions:p,rateOptions:_,statuses:y,vnBanks:x}),[p,_,y,x]),K=f=>{o(f.target.value)};function V(){return`https://pos.crawl.vn/customer_history/GetInvoice?id_customer_history=${Object.keys(n).join("-")}`}return t.jsxs("div",{className:"space-y-6 px-4 py-4",children:[t.jsxs("div",{className:"flex items-center flex-col lg:flex-row justify-between space-y-2",children:[t.jsxs("h2",{className:"text-2xl lg:text-3xl font-bold tracking-tight items-center flex gap-2",children:["Customer Histories"," ",Object.keys(n).length>0&&t.jsx(m,{to:V(),target:"_blank",className:"rounded px-2 py-1 border text-sm",children:"Get Invoices"})]}),t.jsxs("div",{className:"flex items-center flex-col md:flex-row gap-2",children:[t.jsx(A,{type:"search",placeholder:"Search customer histories",value:a,onChange:K,className:"w-80"}),t.jsx(m,{to:d.CUSTOMER_HISTORIES_CREATE,children:t.jsxs(h,{className:"gap-2",children:[t.jsx(E,{})," Create new order"]})})]})]}),t.jsx(P,{data:l==null?void 0:l.result,columns:S,columnVisibility:e,rowCount:l==null?void 0:l.total_data,pagination:i,onColumnVisibilityChange:s,onPaginationChange:c,rowSelection:n,onRowSelectionChange:C})]})}function De(){return t.jsxs(t.Fragment,{children:[t.jsx(D,{children:t.jsx("title",{children:"POS System - Customer Histories"})}),t.jsx($,{})]})}export{De as default};
