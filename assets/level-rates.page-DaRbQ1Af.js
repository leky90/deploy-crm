import{j as e,a as f,Q as c,r as u}from"./index-XwE6gQmn.js";import{a as m,H as b}from"./Helmet-DUuvCvTm.js";import{u as E,D as S}from"./index-BsOMOp0z.js";import{C as F}from"./cell-text-H3JibL2T.js";import{D as h}from"./dialog-button.component-msJRMg9P.js";import{B as s}from"./button-C4HOWXLM.js";import{e as D,T as V,P as M}from"./react-icons.esm-5SUvy-NO.js";import{D as j}from"./dialog-Cq2VxrqT.js";import{z as o,u as K,t as T,F as d}from"./index-MxbznExh.js";import{I as x}from"./input-BFqvYdSA.js";import{L as p}from"./label-DhoCOihp.js";import{R as v}from"./role.component-D8MaKBYp.js";import{u as y}from"./useMutation-Czv1wBp1.js";import{C as _}from"./cell-percent-DV96QzFN.js";import{C as R}from"./cell-currency-D6tOSgAE.js";import{u as B}from"./useQuery-BXJOiSOe.js";import{k as N}from"./index-CwCgg0f3.js";import"./Combination-WE48jzIv.js";import"./index-DWR91OCR.js";import"./index-CROUqNK7.js";import"./select-BLsJIQQv.js";import"./dropdown-menu-oMbE38VB.js";import"./index-Dwx9NaXw.js";import"./index-DrW2nO8L.js";import"./use-auth.cache-CFuprbIQ.js";import"./format-percent-Ca7gawAv.js";import"./format-currency-DwwnROlR.js";const Q=o.object({id:o.coerce.number().optional(),min:o.coerce.number(),max:o.coerce.number(),rate:o.coerce.number()});function L({defaultValues:t,mutation:r,onClose:n}){const{register:a,handleSubmit:l,formState:{errors:i}}=K({defaultValues:t,resolver:T(Q)}),g=async C=>{(await r(C)).status&&n&&n()};return e.jsxs("form",{onSubmit:l(g),className:"space-y-4",autoComplete:"off",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"max",children:"Max"}),e.jsx(x,{placeholder:"Max",...a("max")}),e.jsx(d,{error:i.max})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"min",children:"Min"}),e.jsx(x,{placeholder:"Min",...a("min")}),e.jsx(d,{error:i.min})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"rate",children:"Rate"}),e.jsx(x,{placeholder:"Rate",...a("rate")}),e.jsx(d,{error:i.rate})]}),e.jsx(s,{className:"w-full",children:"Submit"})]})}function k(t){return m({method:"patch",url:"/level_rate",data:t})}function A(){const{mutateAsync:t}=y({mutationFn:k,onSuccess:()=>{f.invalidateQueries({queryKey:c.LEVEL_RATES})}});return{mutationUpdateLevelRate:t}}function P({row:t}){const r=u.useRef(null);function n(){var l;(l=r.current)==null||l.click()}const{mutationUpdateLevelRate:a}=A();return e.jsx(v,{type:"admin",children:e.jsx(h,{title:"Update level rate",trigger:e.jsx(s,{variant:"outline",size:"icon",children:e.jsx(D,{})}),actionButtons:e.jsx(j,{asChild:!0,children:e.jsx(s,{ref:r,type:"button",variant:"secondary",children:"Close"})}),children:e.jsx(L,{defaultValues:t.original,onClose:n,mutation:a})})})}function U(t){return m({method:"delete",url:"/level_rate",data:t})}function I(){const{mutateAsync:t}=y({mutationFn:U,onSuccess:()=>{f.invalidateQueries({queryKey:c.LEVEL_RATES})}});return{mutationDeleteLevelRate:t}}function q({row:t}){const r=u.useRef(null);function n(){var i;(i=r.current)==null||i.click()}const{mutationDeleteLevelRate:a}=I();async function l(){(await a({id:t.original.id})).status&&n()}return e.jsx(v,{type:"admin",children:e.jsx(h,{title:`Delete level rate: ${t.original.id}`,trigger:e.jsx(s,{variant:"destructive",size:"icon",children:e.jsx(V,{})}),actionButtons:e.jsxs(e.Fragment,{children:[e.jsx(s,{type:"button",variant:"destructive",onClick:l,children:"Delete"}),e.jsx(j,{asChild:!0,children:e.jsx(s,{ref:r,type:"button",variant:"secondary",children:"Close"})})]})})})}const w={id:!0,max:!0,min:!0,rate:!0},H=()=>[{accessorKey:"id",header:"ID",enableHiding:!1,cell:t=>e.jsx(F,{children:t.getValue()})},{accessorKey:"min",header:"Min",cell:t=>e.jsx(R,{value:t.getValue()})},{accessorKey:"max",header:"Max",cell:t=>e.jsx(R,{value:t.getValue()})},{accessorKey:"rate",header:"Rate",cell:t=>e.jsx(_,{value:t.getValue()/100})},{id:"actions",enableHiding:!1,cell:({row:t})=>e.jsxs("div",{className:"space-x-2 truncate",children:[e.jsx(P,{row:t}),e.jsx(q,{row:t})]})}];function z(){return m({url:"/level_rate"})}function Y(){const{data:t}=B({queryKey:c.LEVEL_RATES,queryFn:z,gcTime:1e4}),r=u.useMemo(()=>t!=null&&t.status?N(t.result,"id"):{},[t==null?void 0:t.status]);return{levelRates:t==null?void 0:t.result,levelRatesByKey:r}}function G(t){return m({method:"post",url:"/level_rate",data:t})}function O(){const{mutateAsync:t}=y({mutationFn:G,onSuccess:r=>{r.status&&f.invalidateQueries({queryKey:c.LEVEL_RATES})}});return{mutationCreateLevelRate:t}}function $(){const t=u.useRef(null);function r(){var a;(a=t.current)==null||a.click()}const{mutationCreateLevelRate:n}=O();return e.jsx(v,{type:"admin",children:e.jsx(h,{title:"Create level rate",trigger:e.jsxs(s,{className:"gap-2",children:[e.jsx(M,{})," Create level rate"]}),actionButtons:e.jsx(j,{asChild:!0,children:e.jsx(s,{ref:t,type:"button",variant:"secondary",children:"Close"})}),children:e.jsx(L,{onClose:r,mutation:n})})})}function J(){const[t,r]=E("level-rate-columns",{defaultValue:w}),{levelRates:n}=Y(),a=u.useMemo(()=>H(),[]);return e.jsxs("div",{className:"space-y-6 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center flex-col lg:flex-row justify-between space-y-2",children:[e.jsx("h2",{className:"text-2xl lg:text-3xl font-bold tracking-tight",children:"Level Rates"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx($,{})})]}),e.jsx(S,{data:n,columns:a,columnVisibility:t,rowCount:n==null?void 0:n.length,onColumnVisibilityChange:r,hidePagination:!0})]})}function Ee(){return e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx("title",{children:"POS System - List of Users"})}),e.jsx(J,{})]})}export{Ee as default};
